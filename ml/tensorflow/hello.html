<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Cloud, Container, Kubernetes, SDN, Docker" />





  <link rel="alternate" href="/atom.xml" title="Feisky's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="TensorFlow基本操作import tensorflow as tf
简单示例
import tensorflow as tfa = tf.constant(5, name=&quot;input_a&quot;)b = tf.constant(3, name=&quot;input_b&quot;)c = tf.mul(a, b, name=&quot;mul_c&quot;)d = tf.add(a, b, name=&quot;add_d&quot;)e = tf">
<meta property="og:type" content="website">
<meta property="og:title" content="Feisky's Blog">
<meta property="og:url" content="http://feisky.xyz/ml/tensorflow/hello.html">
<meta property="og:site_name" content="Feisky's Blog">
<meta property="og:description" content="TensorFlow基本操作import tensorflow as tf
简单示例
import tensorflow as tfa = tf.constant(5, name=&quot;input_a&quot;)b = tf.constant(3, name=&quot;input_b&quot;)c = tf.mul(a, b, name=&quot;mul_c&quot;)d = tf.add(a, b, name=&quot;add_d&quot;)e = tf">
<meta property="og:image" content="http://feisky.xyz/images/14798939270478.jpg">
<meta property="og:image" content="http://feisky.xyz/images/14798950663351.jpg">
<meta property="og:image" content="http://feisky.xyz/images/14798951652137.jpg">
<meta property="og:image" content="http://feisky.xyz/images/14799079221189.jpg">
<meta property="og:image" content="http://feisky.xyz/images/14799088837355.jpg">
<meta property="og:image" content="http://feisky.xyz/images/14799089956982.jpg">
<meta property="og:updated_time" content="2016-11-28T00:06:26.539Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Feisky's Blog">
<meta name="twitter:description" content="TensorFlow基本操作import tensorflow as tf
简单示例
import tensorflow as tfa = tf.constant(5, name=&quot;input_a&quot;)b = tf.constant(3, name=&quot;input_b&quot;)c = tf.mul(a, b, name=&quot;mul_c&quot;)d = tf.add(a, b, name=&quot;add_d&quot;)e = tf">
<meta name="twitter:image" content="http://feisky.xyz/images/14798939270478.jpg">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://feisky.xyz/ml/tensorflow/hello.html"/>


  <title>
  

  
     | Feisky's Blog
  
</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  


<!-- hexo-inject:begin --><!-- hexo-inject:end --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-69699206-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left  ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Feisky's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Notes about anything.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-pages">
          <a href="/pages" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            笔记
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
      <h1 id="TensorFlow基本操作"><a href="#TensorFlow基本操作" class="headerlink" title="TensorFlow基本操作"></a>TensorFlow基本操作</h1><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div></pre></td></tr></table></figure>
<h2 id="简单示例"><a href="#简单示例" class="headerlink" title="简单示例"></a>简单示例</h2><p><img src="/images/14798939270478.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"></div><div class="line">a = tf.constant(<span class="number">5</span>, name=<span class="string">"input_a"</span>)</div><div class="line">b = tf.constant(<span class="number">3</span>, name=<span class="string">"input_b"</span>)</div><div class="line">c = tf.mul(a, b, name=<span class="string">"mul_c"</span>)</div><div class="line">d = tf.add(a, b, name=<span class="string">"add_d"</span>)</div><div class="line">e = tf.add(c, d, name=<span class="string">"add_e"</span>)</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">    <span class="keyword">print</span> sess.run(e) <span class="comment"># output =&gt; 23</span></div><div class="line">    writer = tf.train.SummaryWriter(<span class="string">"./hello_graph"</span>, sess.graph)</div></pre></td></tr></table></figure>
<p>接着，可以启动tensorboard来查看这个Graph（在jupyter notebookt中可以执行<code>!tensorboard --logdir=&quot;hello_graph&quot;</code>）：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">tensorboard --logdir=<span class="string">"hello_graph"</span></div></pre></td></tr></table></figure>
<p>打开网页<a href="http://localhost:6006" target="_blank" rel="external">http://localhost:6006</a>并切换到GRAPHS标签，可以看到生成的Graph：</p>
<p><img src="/images/14798950663351.jpg" alt=""></p>
<h2 id="Tensor简单示例"><a href="#Tensor简单示例" class="headerlink" title="Tensor简单示例"></a>Tensor简单示例</h2><p>再来看一个输入向量的例子:</p>
<p><img src="/images/14798951652137.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"></div><div class="line">a = tf.constant([<span class="number">5</span>,<span class="number">3</span>], name=<span class="string">"input_a"</span>)</div><div class="line">b = tf.reduce_prod(a, name=<span class="string">"prod_b"</span>)</div><div class="line">c = tf.reduce_sum(a, name=<span class="string">"sum_c"</span>)</div><div class="line">d = tf.add(c, b, name=<span class="string">"add_d"</span>)</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">    <span class="keyword">print</span> sess.run(d) <span class="comment"># =&gt; 23</span></div></pre></td></tr></table></figure>
<h2 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h2><p>常量：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># Constant</span></div><div class="line"></div><div class="line">a = tf.constant(<span class="number">2</span>)</div><div class="line">b = tf.constant(<span class="number">3</span>)</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">    <span class="keyword">print</span> sess.run(a+b)  <span class="comment"># =&gt; 5</span></div></pre></td></tr></table></figure>
<p>变量在计算过程中是可变的，并且在训练过程中会自动更新或优化。如果只想在tf外手动更新变量，那需要声明变量是不可训练的，比如<code>not_trainable = tf.Variable(0, trainable=False)</code>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># Variable</span></div><div class="line"><span class="comment"># Variables maintain state across executions of the </span></div><div class="line"><span class="comment"># graph. The following example shows a variable serving</span></div><div class="line"><span class="comment"># as a simple counter.</span></div><div class="line"></div><div class="line">v1 = tf.Variable(<span class="number">10</span>)</div><div class="line">v2 = tf.Variable(<span class="number">5</span>)</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">    <span class="comment"># variables must be initialized first.</span></div><div class="line">    tf.initialize_all_variables().run(session=sess)</div><div class="line">    <span class="keyword">print</span> sess.run(v1+v2) <span class="comment"># =&gt; 15</span></div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># Placeholder and feed</span></div><div class="line"><span class="comment"># Placeholder is used as Graph input when running session</span></div><div class="line"><span class="comment"># A feed temporarily replaces the output of an operation</span></div><div class="line"><span class="comment"># with a tensor value. You supply feed data as an argument</span></div><div class="line"><span class="comment"># to a run() call. The feed is only used for the run call </span></div><div class="line"><span class="comment"># to which it is passed. The most common use case involves</span></div><div class="line"><span class="comment"># designating specific operations to be "feed" operations</span></div><div class="line"><span class="comment"># by using tf.placeholder() to create them</span></div><div class="line"></div><div class="line">a = tf.placeholder(tf.int16)</div><div class="line">b = tf.placeholder(tf.int16)</div><div class="line"></div><div class="line"><span class="comment"># Define some operations</span></div><div class="line">add = tf.add(a, b)</div><div class="line">mul = tf.mul(a, b)</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">    <span class="keyword">print</span> sess.run(add, feed_dict=&#123;a: <span class="number">2</span>, b: <span class="number">3</span>&#125;)  <span class="comment"># ==&gt; 5</span></div><div class="line">    <span class="keyword">print</span> sess.run(mul, feed_dict=&#123;a: <span class="number">2</span>, b: <span class="number">3</span>&#125;)  <span class="comment"># ==&gt; 6</span></div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># Matrix</span></div><div class="line"></div><div class="line"><span class="comment"># Create a Constant op that produces a 1x2 matrix.  The op is</span></div><div class="line"><span class="comment"># added as a node to the default graph.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># The value returned by the constructor represents the output</span></div><div class="line"><span class="comment"># of the Constant op.</span></div><div class="line">matrix1 = tf.constant([[<span class="number">3.</span>, <span class="number">3.</span>]])</div><div class="line"></div><div class="line"><span class="comment"># Create another Constant that produces a 2x1 matrix.</span></div><div class="line">matrix2 = tf.constant([[<span class="number">2.</span>],[<span class="number">2.</span>]])</div><div class="line"></div><div class="line"><span class="comment"># Create a Matmul op that takes 'matrix1' and 'matrix2' as inputs.</span></div><div class="line"><span class="comment"># The returned value, 'product', represents the result of the matrix</span></div><div class="line"><span class="comment"># multiplication.</span></div><div class="line">product = tf.matmul(matrix1, matrix2)</div><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">    <span class="keyword">print</span> product.eval() <span class="comment"># =&gt; 12</span></div></pre></td></tr></table></figure>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a><a href="https://www.tensorflow.org/versions/master/resources/dims_types.html#tensor-ranks-shapes-and-types" target="_blank" rel="external">数据类型</a></h2><p>Tensorflow有着丰富的数据类型，比如tf.int32, tf.float64等，这些类型跟numpy是一致的。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">a = np.array([<span class="number">2</span>, <span class="number">3</span>], dtype=np.int32)</div><div class="line">b = np.array([<span class="number">4</span>, <span class="number">5</span>], dtype=np.int32)</div><div class="line"><span class="comment"># Use `tf.add()` to initialize an "add" Operation</span></div><div class="line">c = tf.add(a, b)</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">    <span class="keyword">print</span> sess.run(c) <span class="comment"># ==&gt; [6 8]</span></div></pre></td></tr></table></figure>
<h2 id="数学计算"><a href="#数学计算" class="headerlink" title="数学计算"></a>数学计算</h2><p>TF内置了很多的数学计算操作，包括常见的各种数值计算、矩阵运算以及优化算法。</p>
<p>更多见<a href="https://www.tensorflow.org/versions/master/api_docs/python/math_ops.html" target="_blank" rel="external">https://www.tensorflow.org/versions/master/api_docs/python/math_ops.html</a>.</p>
<h2 id="Rank与Shape"><a href="#Rank与Shape" class="headerlink" title="Rank与Shape"></a><a href="https://www.tensorflow.org/versions/master/resources/dims_types.html#tensor-ranks-shapes-and-types" target="_blank" rel="external">Rank与Shape</a></h2><div class="table-container">
<table>
<thead>
<tr>
<th>Rank</th>
<th>Shape</th>
<th>Dimension number</th>
<th>Example                                </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>[]</td>
<td>0-D</td>
<td>A 0-D tensor.  A scalar.               </td>
</tr>
<tr>
<td>1</td>
<td>[D0]</td>
<td>1-D</td>
<td>A 1-D tensor with shape [5].           </td>
</tr>
<tr>
<td>2</td>
<td>[D0, D1]</td>
<td>2-D</td>
<td>A 2-D tensor with shape [3, 4].        </td>
</tr>
<tr>
<td>3</td>
<td>[D0, D1, D2]</td>
<td>3-D</td>
<td>A 3-D tensor with shape [1, 4, 3].     </td>
</tr>
<tr>
<td>n</td>
<td>[D0, D1, … Dn-1]</td>
<td>n-D</td>
<td>A tensor with shape [D0, D1, … Dn-1].</td>
</tr>
</tbody>
</table>
</div>
<h2 id="图和会话"><a href="#图和会话" class="headerlink" title="图和会话"></a>图和会话</h2><p>A TensorFlow graph is a description of computations. To compute anything, a graph must be launched in a Session. A Session places the graph ops onto Devices, such as CPUs or GPUs, and provides methods to execute them. These methods return tensors produced by ops as numpy ndarray objects in Python, and as <code>tensorflow::Tensor</code> instances in C and C++.</p>
<p>如果不指定图，tensorflow会自动创建一个，可以通过<code>tf.get_default_graph()</code>来获取这个默认图。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">graph = tf.Graph()</div><div class="line"><span class="keyword">with</span> graph.as_default():</div><div class="line">    value1 = tf.constant([<span class="number">1.</span>, <span class="number">2.</span>])</div><div class="line">    value2 = tf.Variable([<span class="number">3.</span>, <span class="number">4.</span>])</div><div class="line">    result = value1*value2</div><div class="line"><span class="keyword">with</span> tf.Session(graph=graph) <span class="keyword">as</span> sess:</div><div class="line">    tf.initialize_all_variables().run()</div><div class="line">    <span class="keyword">print</span> sess.run(result)</div><div class="line">    <span class="keyword">print</span> result.eval()</div><div class="line"></div><div class="line"><span class="comment"># result =&gt;</span></div><div class="line"><span class="comment">#    [ 3.  8.]</span></div><div class="line"><span class="comment">#    [ 3.  8.]</span></div></pre></td></tr></table></figure>
<p>在指定GPU上计算:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">  <span class="keyword">with</span> tf.device(<span class="string">"/gpu:1"</span>):</div><div class="line">    matrix1 = tf.constant([[<span class="number">3.</span>, <span class="number">3.</span>]])</div><div class="line">    matrix2 = tf.constant([[<span class="number">2.</span>],[<span class="number">2.</span>]])</div><div class="line">    product = tf.matmul(matrix1, matrix2)</div><div class="line">    ...</div></pre></td></tr></table></figure>
<p>在IPython中可以使用InteractiveSession来简化Session操作：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">sess = tf.InteractiveSession()</div><div class="line"></div><div class="line">x = tf.Variable([<span class="number">1.0</span>, <span class="number">2.0</span>])</div><div class="line">a = tf.constant([<span class="number">3.0</span>, <span class="number">3.0</span>])</div><div class="line"></div><div class="line"><span class="comment"># Initialize 'x' using the run() method of its initializer op.</span></div><div class="line">x.initializer.run()</div><div class="line"></div><div class="line"><span class="comment"># Add an op to subtract 'a' from 'x'.  Run it and print the result</span></div><div class="line">sub = tf.sub(x, a)</div><div class="line">print(sub.eval())  <span class="comment"># ==&gt; [-2. -1.]</span></div><div class="line"></div><div class="line"><span class="comment"># Close the Session when we're done.</span></div><div class="line">sess.close()</div></pre></td></tr></table></figure>
<h2 id="Name-Scope"><a href="#Name-Scope" class="headerlink" title="Name Scope"></a>Name Scope</h2><p>Name scopes可以把复杂操作分成小的命名块，方便组织复杂的图，并方便在TensorBoard展示。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.name_scope(<span class="string">"Scope_A"</span>):</div><div class="line">    a = tf.add(<span class="number">1</span>, <span class="number">2</span>, name=<span class="string">"A_add"</span>)</div><div class="line">    b = tf.mul(a, <span class="number">3</span>, name=<span class="string">"A_mul"</span>)</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.name_scope(<span class="string">"Scope_B"</span>):</div><div class="line">    c = tf.add(<span class="number">4</span>, <span class="number">5</span>, name=<span class="string">"B_add"</span>)</div><div class="line">    d = tf.mul(c, <span class="number">6</span>, name=<span class="string">"B_mul"</span>)</div><div class="line"></div><div class="line">e = tf.add(b, d, name=<span class="string">"output"</span>)</div><div class="line">writer = tf.train.SummaryWriter(<span class="string">'./name_scope_1'</span>, graph=tf.get_default_graph())</div><div class="line">writer.close()</div></pre></td></tr></table></figure>
<p><img src="/images/14799079221189.jpg" alt=""></p>
<h2 id="一个完整示例"><a href="#一个完整示例" class="headerlink" title="一个完整示例"></a>一个完整示例</h2><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"></div><div class="line"><span class="comment"># Define a new Graph</span></div><div class="line">graph = tf.Graph()</div><div class="line"></div><div class="line"><span class="keyword">with</span> graph.as_default():</div><div class="line"></div><div class="line">    <span class="keyword">with</span> tf.name_scope(<span class="string">"variables"</span>):</div><div class="line">        <span class="comment"># Variable to keep track of how many times the graph has been run</span></div><div class="line">        global_step = tf.Variable(<span class="number">0</span>, dtype=tf.int32, trainable=<span class="keyword">False</span>, name=<span class="string">"global_step"</span>)</div><div class="line"></div><div class="line">        <span class="comment"># Variable that keeps track of the sum of all output values over time:</span></div><div class="line">        total_output = tf.Variable(<span class="number">0.0</span>, dtype=tf.float32, trainable=<span class="keyword">False</span>, name=<span class="string">"total_output"</span>)</div><div class="line"></div><div class="line">    <span class="comment"># Primary transformation Operations</span></div><div class="line">    <span class="keyword">with</span> tf.name_scope(<span class="string">"transformation"</span>):</div><div class="line">        <span class="comment"># Separate input layer</span></div><div class="line">        <span class="keyword">with</span> tf.name_scope(<span class="string">"input"</span>):</div><div class="line">            <span class="comment"># Create input placeholder- takes in a Vector</span></div><div class="line">            a = tf.placeholder(tf.float32, shape=[<span class="keyword">None</span>], name=<span class="string">"input_placeholder_a"</span>)</div><div class="line"></div><div class="line">        <span class="comment"># Separate middle layer</span></div><div class="line">        <span class="keyword">with</span> tf.name_scope(<span class="string">"intermediate_layer"</span>):</div><div class="line">            b = tf.reduce_prod(a, name=<span class="string">"product_b"</span>)</div><div class="line">            c = tf.reduce_sum(a, name=<span class="string">"sum_c"</span>)</div><div class="line"></div><div class="line">        <span class="comment"># Separate output layer</span></div><div class="line">        <span class="keyword">with</span> tf.name_scope(<span class="string">"output"</span>):</div><div class="line">            output = tf.add(b, c, name=<span class="string">"output"</span>)</div><div class="line"></div><div class="line">    <span class="keyword">with</span> tf.name_scope(<span class="string">"update"</span>):</div><div class="line">        <span class="comment"># Increments the total_output Variable by the latest output</span></div><div class="line">        update_total = total_output.assign_add(output)</div><div class="line"></div><div class="line">        <span class="comment"># Increments the above `global_step` Variable, should be run whenever the graph is run</span></div><div class="line">        increment_step = global_step.assign_add(<span class="number">1</span>)</div><div class="line"></div><div class="line">    <span class="comment"># Summary Operations</span></div><div class="line">    <span class="keyword">with</span> tf.name_scope(<span class="string">"summaries"</span>):</div><div class="line">        avg = tf.div(update_total, tf.cast(increment_step, tf.float32), name=<span class="string">"average"</span>)</div><div class="line"></div><div class="line">        <span class="comment"># Creates summaries for output node</span></div><div class="line">        tf.scalar_summary(<span class="string">b'Output'</span>, output, name=<span class="string">"output_summary"</span>)</div><div class="line">        tf.scalar_summary(<span class="string">b'Sum of outputs over time'</span>, update_total, name=<span class="string">"total_summary"</span>)</div><div class="line">        tf.scalar_summary(<span class="string">b'Average of outputs over time'</span>, avg, name=<span class="string">"average_summary"</span>)</div><div class="line"></div><div class="line">    <span class="comment"># Global Variables and Operations</span></div><div class="line">    <span class="keyword">with</span> tf.name_scope(<span class="string">"global_ops"</span>):</div><div class="line">        <span class="comment"># Initialization Op</span></div><div class="line">        init = tf.initialize_all_variables()</div><div class="line">        <span class="comment"># Merge all summaries into one Operation</span></div><div class="line">        merged_summaries = tf.merge_all_summaries()</div><div class="line"></div><div class="line"><span class="comment"># Start a Session, using the explicitly created Graph</span></div><div class="line">sess = tf.Session(graph=graph)</div><div class="line"></div><div class="line"><span class="comment"># Open a SummaryWriter to save summaries</span></div><div class="line">writer = tf.train.SummaryWriter(<span class="string">'./improved_graph'</span>, graph)</div><div class="line"></div><div class="line"><span class="comment"># Initialize Variables</span></div><div class="line">sess.run(init)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_graph</span><span class="params">(input_tensor)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Helper function; runs the graph with given input tensor and saves summaries</div><div class="line">    """</div><div class="line">    feed_dict = &#123;a: input_tensor&#125;</div><div class="line">    _, step, summary = sess.run([output, increment_step, merged_summaries],</div><div class="line">                                  feed_dict=feed_dict)</div><div class="line">    writer.add_summary(summary, global_step=step)</div><div class="line"></div><div class="line"><span class="comment"># run graph with some inputs</span></div><div class="line">run_graph([<span class="number">2</span>,<span class="number">8</span>])</div><div class="line">run_graph([<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>])</div><div class="line">run_graph([<span class="number">8</span>])</div><div class="line">run_graph([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line">run_graph([<span class="number">11</span>,<span class="number">4</span>])</div><div class="line">run_graph([<span class="number">4</span>,<span class="number">1</span>])</div><div class="line">run_graph([<span class="number">7</span>,<span class="number">3</span>,<span class="number">1</span>])</div><div class="line">run_graph([<span class="number">6</span>,<span class="number">3</span>])</div><div class="line">run_graph([<span class="number">0</span>,<span class="number">2</span>])</div><div class="line">run_graph([<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</div><div class="line"></div><div class="line"><span class="comment"># flush summeries to disk</span></div><div class="line">writer.flush()</div><div class="line"></div><div class="line"><span class="comment"># close writer and session</span></div><div class="line">writer.close()</div><div class="line">sess.close()</div></pre></td></tr></table></figure>
<p>Tensorboard图：</p>
<p><img src="/images/14799088837355.jpg" alt=""></p>
<p>Tensorboard事件：</p>
<p><img src="/images/14799089956982.jpg" alt=""></p>

    
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/qrcode.jpg"
               alt="Feisky" />
          <p class="site-author-name" itemprop="name">Feisky</p>
          <p class="site-description motion-element" itemprop="description">Notes about anything.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">90</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/feiskyer" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/feisky" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/371069890" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/feisky/" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  博客园
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#TensorFlow基本操作"><span class="nav-number">1.</span> <span class="nav-text">TensorFlow基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#简单示例"><span class="nav-number">1.1.</span> <span class="nav-text">简单示例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tensor简单示例"><span class="nav-number">1.2.</span> <span class="nav-text">Tensor简单示例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本类型"><span class="nav-number">1.3.</span> <span class="nav-text">基本类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据类型"><span class="nav-number">1.4.</span> <span class="nav-text">数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数学计算"><span class="nav-number">1.5.</span> <span class="nav-text">数学计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rank与Shape"><span class="nav-number">1.6.</span> <span class="nav-text">Rank与Shape</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#图和会话"><span class="nav-number">1.7.</span> <span class="nav-text">图和会话</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Name-Scope"><span class="nav-number">1.8.</span> <span class="nav-text">Name Scope</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一个完整示例"><span class="nav-number">1.9.</span> <span class="nav-text">一个完整示例</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Feisky</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = decodeURIComponent(data.url);
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


  


</body>
</html>
