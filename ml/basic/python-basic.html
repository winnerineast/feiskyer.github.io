<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Cloud, Container, Kubernetes, SDN, Docker" />





  <link rel="alternate" href="/atom.xml" title="Feisky's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="Preliminaries with Python/Notebook
Parag K. Mital
Creative Applications of Deep Learning w/ Tensorflow
Kadenze Academy
#CADL


This work is licensed under a Creative Commons Attribution-NonCommercial-">
<meta property="og:type" content="website">
<meta property="og:title" content="Feisky's Blog">
<meta property="og:url" content="http://feisky.xyz/ml/basic/python-basic.html">
<meta property="og:site_name" content="Feisky's Blog">
<meta property="og:description" content="Preliminaries with Python/Notebook
Parag K. Mital
Creative Applications of Deep Learning w/ Tensorflow
Kadenze Academy
#CADL


This work is licensed under a Creative Commons Attribution-NonCommercial-">
<meta property="og:image" content="http://feisky.xyz/output_41_1.png">
<meta property="og:image" content="http://feisky.xyz/output_45_1.png">
<meta property="og:image" content="http://feisky.xyz/output_45_2.png">
<meta property="og:image" content="http://feisky.xyz/output_45_3.png">
<meta property="og:image" content="http://feisky.xyz/output_59_1.png">
<meta property="og:image" content="http://feisky.xyz/output_63_0.png">
<meta property="og:image" content="http://feisky.xyz/output_65_0.png">
<meta property="og:image" content="http://feisky.xyz/output_75_1.png">
<meta property="og:image" content="http://feisky.xyz/output_77_1.png">
<meta property="og:image" content="http://feisky.xyz/output_79_2.png">
<meta property="og:image" content="http://feisky.xyz/output_83_1.png">
<meta property="og:updated_time" content="2016-12-19T00:18:07.993Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Feisky's Blog">
<meta name="twitter:description" content="Preliminaries with Python/Notebook
Parag K. Mital
Creative Applications of Deep Learning w/ Tensorflow
Kadenze Academy
#CADL


This work is licensed under a Creative Commons Attribution-NonCommercial-">
<meta name="twitter:image" content="http://feisky.xyz/output_41_1.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://feisky.xyz/ml/basic/python-basic.html"/>


  <title>
  

  
     | Feisky's Blog
  
</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  


<!-- hexo-inject:begin --><!-- hexo-inject:end --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-69699206-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left  ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Feisky's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Notes about anything.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-pages">
          <a href="/pages" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            笔记
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
      <h1 id="Preliminaries-with-Python-Notebook"><a href="#Preliminaries-with-Python-Notebook" class="headerlink" title="Preliminaries with Python/Notebook"></a>Preliminaries with Python/Notebook</h1><p class="lead">
Parag K. Mital<br>
<a href="https://www.kadenze.com/courses/creative-applications-of-deep-learning-with-tensorflow/info" target="_blank" rel="external">Creative Applications of Deep Learning w/ Tensorflow</a><br>
<a href="https://www.kadenze.com/partners/kadenze-academy" target="_blank" rel="external">Kadenze Academy</a><br>
<a href="https://twitter.com/hashtag/CADL" target="_blank" rel="external">#CADL</a>
</p>

<p>This work is licensed under a <a rel="external" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>
<p><a name="learning-goals"></a></p>
<h1 id="Learning-Goals"><a href="#Learning-Goals" class="headerlink" title="Learning Goals"></a>Learning Goals</h1><ul>
<li>Install and run Jupyter Notebook with the Tensorflow library</li>
<li>Learn to create a dataset of images using <code>os.listdir</code> and <code>plt.imread</code></li>
<li>Understand how images are represented when using float or uint8</li>
<li>Learn how to crop and resize images to a standard size.</li>
</ul>
<h1 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h1><!-- MarkdownTOC autolink=true autoanchor=true bracket=round -->
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#using-notebook">Using Notebook</a><ul>
<li><a href="#cells">Cells</a></li>
<li><a href="#kernel">Kernel</a></li>
<li><a href="#importing-libraries">Importing Libraries</a></li>
</ul>
</li>
<li><a href="#loading-data">Loading Data</a><ul>
<li><a href="#structuring-data-as-folders">Structuring data as folders</a></li>
<li><a href="#using-the-os-library-to-get-data">Using the <code>os</code> library to get data</a></li>
<li><a href="#loading-an-image">Loading an image</a></li>
<li><a href="#rgb-image-representation">RGB Image Representation</a></li>
<li><a href="#understanding-data-types-and-ranges-uint8-float32">Understanding data types and ranges (uint8, float32)</a></li>
<li><a href="#visualizing-your-data-as-images">Visualizing your data as images</a></li>
</ul>
</li>
<li><a href="#image-manipulation">Image Manipulation</a><ul>
<li><a href="#cropping-images">Cropping images</a></li>
<li><a href="#resizing-images">Resizing images</a></li>
<li><a href="#croppingresizing-images">Cropping/Resizing Images</a></li>
<li><a href="#the-batch-dimension">The Batch Dimension</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<!-- /MarkdownTOC -->
<p><a name="introduction"></a></p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This preliminary session will cover the basics of working with image data in Python, and creating an image dataset.  Please make sure you are running at least Python 3.4 and have Tensorflow 0.9.0 or higher installed.  If you are unsure of how to do this, please make sure you have followed the <a href="../README.md#installation-preliminaries">installation instructions</a>.  We’ll also cover loading images from a directory, resizing and cropping images, and changing an image datatype from unsigned int to float32.  If you feel comfortable with all of this, please feel free to skip straight to Session 1.  Otherwise, launch <code>jupyter notebook</code> and make sure you are reading the <code>session-0.ipynb</code> file. </p>
<p><a name="using-notebook"></a></p>
<h1 id="Using-Notebook"><a href="#Using-Notebook" class="headerlink" title="Using Notebook"></a>Using Notebook</h1><p><em>Make sure you have launched <code>jupyter notebook</code> and are reading the <code>session-0.ipynb</code> file</em>.  If you are unsure of how to do this, please make sure you follow the <a href="../README.md#installation-preliminaries">installation instructions</a>.  This will allow you to interact with the contents and run the code using an interactive python kernel!</p>
<p><a name="cells"></a></p>
<h2 id="Cells"><a href="#Cells" class="headerlink" title="Cells"></a>Cells</h2><p>After launching this notebook, try running/executing the next cell by pressing shift-enter on it.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="number">4</span>*<span class="number">2</span></div></pre></td></tr></table></figure>
<pre><code>8
</code></pre><p>Now press ‘a’ or ‘b’ to create new cells.  You can also use the toolbar to create new cells.  You can also use the arrow keys to move up and down.</p>
<p><a name="kernel"></a></p>
<h2 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h2><p>Note the numbers on each of the cells inside the brackets, after “running” the cell.  These denote the current execution count of your python “kernel”.  Think of the kernel as another machine within your computer that understands Python and interprets what you write as code into executions that the processor can understand.</p>
<p><a name="importing-libraries"></a></p>
<h2 id="Importing-Libraries"><a href="#Importing-Libraries" class="headerlink" title="Importing Libraries"></a>Importing Libraries</h2><p>When you launch a new notebook, your kernel is a blank state.  It only knows standard python syntax.  Everything else is contained in additional python libraries that you have to explicitly “import” like so:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div></pre></td></tr></table></figure>
<p>After exectuing this cell, your kernel will have access to everything inside the <code>os</code> library which is a common library for interacting with the operating system.  We’ll need to use the import statement for all of the libraries that we include.</p>
<p><a name="loading-data"></a></p>
<h1 id="Loading-Data"><a href="#Loading-Data" class="headerlink" title="Loading Data"></a>Loading Data</h1><p>Let’s now move onto something more practical.  We’ll learn how to see what files are in a directory, and load any images inside that directory into a variable.</p>
<p><a name="structuring-data-as-folders"></a></p>
<h2 id="Structuring-data-as-folders"><a href="#Structuring-data-as-folders" class="headerlink" title="Structuring data as folders"></a>Structuring data as folders</h2><p>With Deep Learning, we’ll always need a dataset, or a collection of data.  A lot of it.  We’re going to create our dataset by putting a bunch of images inside a directory. Then, whenever we want to load the dataset, we will tell python to find all the images inside the directory and load them.  Python lets us very easily crawl through a directory and grab each file.  Let’s have a look at how to do this.</p>
<p><a name="using-the-os-library-to-get-data"></a></p>
<h2 id="Using-the-os-library-to-get-data"><a href="#Using-the-os-library-to-get-data" class="headerlink" title="Using the os library to get data"></a>Using the <code>os</code> library to get data</h2><p>We’ll practice with a very large dataset called Celeb Net.  This dataset has about 200,000 images of celebrities.  The researchers also provide a version of the dataset which has every single face cropped and aligned so that each face is in the middle!  We’ll be using this aligned dataset.  To read more about the dataset or to download it, follow the link here:</p>
<p><a href="http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html" target="_blank" rel="external">http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html</a></p>
<p>For now, we’re not going to be using the entire dataset but just a subset of it.  Run the following cell which will download the first 10 images for you:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># Load the os library</span></div><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line"><span class="comment"># Load the request module</span></div><div class="line"><span class="keyword">import</span> urllib</div><div class="line"></div><div class="line"><span class="comment"># Create a directory</span></div><div class="line">os.mkdir(<span class="string">'img_align_celeba'</span>)</div><div class="line"></div><div class="line"><span class="comment"># Now perform the following 10 times:</span></div><div class="line"><span class="keyword">for</span> img_i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">11</span>):</div><div class="line"></div><div class="line">    <span class="comment"># create a string using the current loop counter</span></div><div class="line">    f = <span class="string">'000%03d.jpg'</span> % img_i</div><div class="line"></div><div class="line">    <span class="comment"># and get the url with that string appended the end</span></div><div class="line">    url = <span class="string">'https://s3.amazonaws.com/cadl/celeb-align/'</span> + f</div><div class="line"></div><div class="line">    <span class="comment"># We'll print this out to the console so we can see how far we've gone</span></div><div class="line">    <span class="keyword">print</span> url</div><div class="line"></div><div class="line">    <span class="comment"># And now download the url to a location inside our new directory</span></div><div class="line">    urllib.urlretrieve(url, os.path.join(<span class="string">'img_align_celeba'</span>, f))</div></pre></td></tr></table></figure>
<pre><code>https://s3.amazonaws.com/cadl/celeb-align/000001.jpg
https://s3.amazonaws.com/cadl/celeb-align/000002.jpg
https://s3.amazonaws.com/cadl/celeb-align/000003.jpg
https://s3.amazonaws.com/cadl/celeb-align/000004.jpg
https://s3.amazonaws.com/cadl/celeb-align/000005.jpg
https://s3.amazonaws.com/cadl/celeb-align/000006.jpg
https://s3.amazonaws.com/cadl/celeb-align/000007.jpg
https://s3.amazonaws.com/cadl/celeb-align/000008.jpg
https://s3.amazonaws.com/cadl/celeb-align/000009.jpg
https://s3.amazonaws.com/cadl/celeb-align/000010.jpg
</code></pre><p>Using the <code>os</code> package, we can list an entire directory.  The documentation or docstring, says that <code>listdir</code> takes one parameter, <code>path</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">help(os.listdir)</div></pre></td></tr></table></figure>
<pre><code>Help on built-in function listdir in module posix:

listdir(...)
    listdir(path) -&gt; list_of_strings

    Return a list containing the names of the entries in the directory.

        path: path of directory to list

    The list is in arbitrary order.  It does not include the special
    entries &#39;.&#39; and &#39;..&#39; even if they are present in the directory.
</code></pre><p>This is the location of the directory we need to list.  Let’s try this with the directory of images we just downloaded:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">files = os.listdir(<span class="string">'img_align_celeba'</span>)</div></pre></td></tr></table></figure>
<p>We can also specify to include only certain files like so:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">[file_i <span class="keyword">for</span> file_i <span class="keyword">in</span> os.listdir(<span class="string">'img_align_celeba'</span>) <span class="keyword">if</span> <span class="string">'.jpg'</span> <span class="keyword">in</span> file_i]</div></pre></td></tr></table></figure>
<pre><code>[&#39;000001.jpg&#39;,
 &#39;000002.jpg&#39;,
 &#39;000003.jpg&#39;,
 &#39;000008.jpg&#39;,
 &#39;000006.jpg&#39;,
 &#39;000009.jpg&#39;,
 &#39;000007.jpg&#39;,
 &#39;000004.jpg&#39;,
 &#39;000005.jpg&#39;,
 &#39;000010.jpg&#39;]
</code></pre><p>or even:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">[file_i <span class="keyword">for</span> file_i <span class="keyword">in</span> os.listdir(<span class="string">'img_align_celeba'</span>)</div><div class="line"> <span class="keyword">if</span> <span class="string">'.jpg'</span> <span class="keyword">in</span> file_i <span class="keyword">and</span> <span class="string">'00000'</span> <span class="keyword">in</span> file_i]</div></pre></td></tr></table></figure>
<pre><code>[&#39;000001.jpg&#39;,
 &#39;000002.jpg&#39;,
 &#39;000003.jpg&#39;,
 &#39;000008.jpg&#39;,
 &#39;000006.jpg&#39;,
 &#39;000009.jpg&#39;,
 &#39;000007.jpg&#39;,
 &#39;000004.jpg&#39;,
 &#39;000005.jpg&#39;]
</code></pre><p>We could also combine file types if we happened to have multiple types:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">[file_i <span class="keyword">for</span> file_i <span class="keyword">in</span> os.listdir(<span class="string">'img_align_celeba'</span>)</div><div class="line"> <span class="keyword">if</span> <span class="string">'.jpg'</span> <span class="keyword">in</span> file_i <span class="keyword">or</span> <span class="string">'.png'</span> <span class="keyword">in</span> file_i <span class="keyword">or</span> <span class="string">'.jpeg'</span> <span class="keyword">in</span> file_i]</div></pre></td></tr></table></figure>
<pre><code>[&#39;000001.jpg&#39;,
 &#39;000002.jpg&#39;,
 &#39;000003.jpg&#39;,
 &#39;000008.jpg&#39;,
 &#39;000006.jpg&#39;,
 &#39;000009.jpg&#39;,
 &#39;000007.jpg&#39;,
 &#39;000004.jpg&#39;,
 &#39;000005.jpg&#39;,
 &#39;000010.jpg&#39;]
</code></pre><p>Let’s set this list to a variable, so we can perform further actions on it:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">files = [file_i</div><div class="line">         <span class="keyword">for</span> file_i <span class="keyword">in</span> os.listdir(<span class="string">'img_align_celeba'</span>)</div><div class="line">         <span class="keyword">if</span> file_i.endswith(<span class="string">'.jpg'</span>)]</div></pre></td></tr></table></figure>
<p>And now we can index that list using the square brackets:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">print(files[<span class="number">0</span>])</div><div class="line">print(files[<span class="number">1</span>])</div></pre></td></tr></table></figure>
<pre><code>000001.jpg
000002.jpg
</code></pre><p>We can even go in the reverse direction, which wraps around to the end of the list:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">print(files[<span class="number">-1</span>])</div><div class="line">print(files[<span class="number">-2</span>])</div></pre></td></tr></table></figure>
<pre><code>000010.jpg
000005.jpg
</code></pre><p><a name="loading-an-image"></a></p>
<h2 id="Loading-an-image"><a href="#Loading-an-image" class="headerlink" title="Loading an image"></a>Loading an image</h2><p><code>matplotlib</code> is an incredibly powerful python library which will let us play with visualization and loading of image data.  We can import it like so:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div></pre></td></tr></table></figure>
<p>Now we can refer to the entire module by just using <code>plt</code> instead of <code>matplotlib.pyplot</code> every time.  This is pretty common practice.</p>
<p>We’ll now tell matplotlib to “inline” plots using an ipython magic function:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">%matplotlib inline</div></pre></td></tr></table></figure>
<p>This isn’t python, so won’t work inside of any python script files.  This only works inside notebook.  What this is saying is that whenever we plot something using matplotlib, put the plots directly into the notebook, instead of using a window popup, which is the default behavior.  This is something that makes notebook really useful for teaching purposes, as it allows us to keep all of our images/code in one document.</p>
<p>Have a look at the library by using <code>plt</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># help(plt)</span></div><div class="line"><span class="comment"># plt.&lt;tab&gt;</span></div></pre></td></tr></table></figure>
<p><code>plt</code> contains a very useful function for loading images:</p>
<figure class="highlight"><table><tr><td class="code"><pre><div class="line">plt.imread?</div></pre></td></tr></table></figure>
<p>Here we see that it actually returns a variable which requires us to use another library, <code>NumPy</code>.  NumPy makes working with numerical data <em>a lot</em> easier.  Let’s import it as well:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="comment"># help(np)</span></div><div class="line"><span class="comment"># np.&lt;tab&gt;</span></div></pre></td></tr></table></figure>
<p>Let’s try loading the first image in our dataset:</p>
<p>We have a list of filenames, and we know where they are.  But we need to combine the path to the file and the filename itself.  If we try and do this:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># img = plt.imread(files[0])</span></div><div class="line"><span class="comment"># outputs: FileNotFoundError</span></div></pre></td></tr></table></figure>
<p><code>plt.imread</code> will not know where that file is.  We can tell it where to find the file by using os.path.join:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">print(os.path.join(<span class="string">'img_align_celeba'</span>, files[<span class="number">0</span>]))</div><div class="line">plt.imread(os.path.join(<span class="string">'img_align_celeba'</span>, files[<span class="number">0</span>]))</div></pre></td></tr></table></figure>
<pre><code>img_align_celeba/000001.jpg





array([[[253, 231, 194],
        [253, 231, 194],
        [253, 231, 194],
        ..., 
        [247, 226, 225],
        [254, 238, 222],
        [254, 238, 222]],

       [[253, 231, 194],
        [253, 231, 194],
        [253, 231, 194],
        ..., 
        [249, 228, 225],
        [254, 238, 222],
        [254, 238, 222]],

       [[253, 231, 194],
        [253, 231, 194],
        [253, 231, 194],
        ..., 
        [250, 231, 227],
        [255, 239, 223],
        [255, 239, 223]],

       ..., 
       [[140,  74,  26],
        [116,  48,   1],
        [146,  78,  33],
        ..., 
        [122,  55,  28],
        [122,  56,  30],
        [122,  56,  30]],

       [[130,  62,  15],
        [138,  70,  23],
        [166,  98,  53],
        ..., 
        [118,  49,  20],
        [118,  51,  24],
        [118,  51,  24]],

       [[168, 100,  53],
        [204, 136,  89],
        [245, 177, 132],
        ..., 
        [118,  49,  20],
        [120,  50,  24],
        [120,  50,  24]]], dtype=uint8)
</code></pre><p>Now we get a bunch of numbers!  I’d rather not have to keep prepending the path to my files, so I can create the list of files like so:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">files = [os.path.join(<span class="string">'img_align_celeba'</span>, file_i)</div><div class="line"> <span class="keyword">for</span> file_i <span class="keyword">in</span> os.listdir(<span class="string">'img_align_celeba'</span>)</div><div class="line"> <span class="keyword">if</span> <span class="string">'.jpg'</span> <span class="keyword">in</span> file_i]</div></pre></td></tr></table></figure>
<p>Let’s set this to a variable, <code>img</code>, and inspect a bit further what’s going on:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">img = plt.imread(files[<span class="number">0</span>])</div><div class="line"><span class="comment"># img.&lt;tab&gt;</span></div></pre></td></tr></table></figure>
<p><a name="rgb-image-representation"></a></p>
<h2 id="RGB-Image-Representation"><a href="#RGB-Image-Representation" class="headerlink" title="RGB Image Representation"></a>RGB Image Representation</h2><p>It turns out that all of these numbers are capable of describing an image.  We can use the function <code>imshow</code> to see this:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">img = plt.imread(files[<span class="number">0</span>])</div><div class="line">plt.imshow(img)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f0efae733d0&gt;
</code></pre><p><img src="output_41_1.png" alt="png"></p>
<p>Let’s break this data down a bit more.  We can see the dimensions of the data using the <code>shape</code> accessor:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">img.shape</div><div class="line"><span class="comment"># outputs: (218, 178, 3)</span></div></pre></td></tr></table></figure>
<pre><code>(218, 178, 3)
</code></pre><p>This means that the image has 218 rows, 178 columns, and 3 color channels corresponding to the Red, Green, and Blue channels of the image, or RGB.  Let’s try looking at just one of the color channels.  We can use the square brackets just like when we tried to access elements of our list:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">plt.figure()</div><div class="line">plt.imshow(img[:, :, <span class="number">0</span>])</div><div class="line">plt.figure()</div><div class="line">plt.imshow(img[:, :, <span class="number">1</span>])</div><div class="line">plt.figure()</div><div class="line">plt.imshow(img[:, :, <span class="number">2</span>])</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f0ef943b410&gt;
</code></pre><p><img src="output_45_1.png" alt="png"></p>
<p><img src="output_45_2.png" alt="png"></p>
<p><img src="output_45_3.png" alt="png"></p>
<p>We use the special colon operator to say take every value in this dimension.  This is saying, give me every row, every column, and the 0th dimension of the color channels.</p>
<p>What we see now is a heatmap of our image corresponding to each color channel.</p>
<p><a name="understanding-data-types-and-ranges-uint8-float32"></a></p>
<h2 id="Understanding-data-types-and-ranges-uint8-float32"><a href="#Understanding-data-types-and-ranges-uint8-float32" class="headerlink" title="Understanding data types and ranges (uint8, float32)"></a>Understanding data types and ranges (uint8, float32)</h2><p>Let’s take a look at the range of values of our image:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">np.min(img), np.max(img)</div></pre></td></tr></table></figure>
<pre><code>(0, 255)
</code></pre><p>The numbers are all between 0 to 255.  What a strange number you might be thinking.  Unless you are one of 10 types of people in this world, those that understand binary and those that don’t.  Don’t worry if you’re not.  You are likely better off.</p>
<p>256 values is how much information we can stick into a byte.  We measure a byte using bits, and each byte takes up 8 bits.  Each bit can be either 0 or 1.  When we stack up 8 bits, or 10000000 in binary, equivalent to 2 to the 8th power, we can express up to 256 possible values, giving us our range, 0 to 255.  You can compute any number of bits using powers of two.  2 to the power of 8 is 256.  How many values can you stick in 16 bits (2 bytes)?  Or 32 bits (4 bytes) of information?  Let’s ask python:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="number">2</span>**<span class="number">32</span></div></pre></td></tr></table></figure>
<pre><code>4294967296
</code></pre><p>numpy arrays have a field which will tell us how many bits they are using: <code>dtype</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">img.dtype</div></pre></td></tr></table></figure>
<pre><code>dtype(&#39;uint8&#39;)
</code></pre><p><code>uint8</code>:  Let’s decompose that:  <code>unsigned</code>, <code>int</code>, <code>8</code>.  That means the values do not have a sign, meaning they are all positive.  They are only integers, meaning no decimal places. And that they are all 8 bits.</p>
<p>Something which is 32-bits of information can express a single value with a range of nearly 4.3 billion different possibilities (2**32).  We’ll generally need to work with 32-bit data when working with neural networks.  In order to do that, we can simply ask numpy for the correct data type:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">img.astype(np.float32)</div></pre></td></tr></table></figure>
<pre><code>array([[[ 253.,  231.,  194.],
        [ 253.,  231.,  194.],
        [ 253.,  231.,  194.],
        ..., 
        [ 247.,  226.,  225.],
        [ 254.,  238.,  222.],
        [ 254.,  238.,  222.]],

       [[ 253.,  231.,  194.],
        [ 253.,  231.,  194.],
        [ 253.,  231.,  194.],
        ..., 
        [ 249.,  228.,  225.],
        [ 254.,  238.,  222.],
        [ 254.,  238.,  222.]],

       [[ 253.,  231.,  194.],
        [ 253.,  231.,  194.],
        [ 253.,  231.,  194.],
        ..., 
        [ 250.,  231.,  227.],
        [ 255.,  239.,  223.],
        [ 255.,  239.,  223.]],

       ..., 
       [[ 140.,   74.,   26.],
        [ 116.,   48.,    1.],
        [ 146.,   78.,   33.],
        ..., 
        [ 122.,   55.,   28.],
        [ 122.,   56.,   30.],
        [ 122.,   56.,   30.]],

       [[ 130.,   62.,   15.],
        [ 138.,   70.,   23.],
        [ 166.,   98.,   53.],
        ..., 
        [ 118.,   49.,   20.],
        [ 118.,   51.,   24.],
        [ 118.,   51.,   24.]],

       [[ 168.,  100.,   53.],
        [ 204.,  136.,   89.],
        [ 245.,  177.,  132.],
        ..., 
        [ 118.,   49.,   20.],
        [ 120.,   50.,   24.],
        [ 120.,   50.,   24.]]], dtype=float32)
</code></pre><p>This is saying, let me see this data as a floating point number, meaning with decimal places, and with 32 bits of precision, rather than the previous data types 8 bits.  This will become important when we start to work with neural networks, as we’ll need all of those extra possible values!</p>
<p><a name="visualizing-your-data-as-images"></a></p>
<h2 id="Visualizing-your-data-as-images"><a href="#Visualizing-your-data-as-images" class="headerlink" title="Visualizing your data as images"></a>Visualizing your data as images</h2><p>We’ve seen how to look at a single image.  But what if we have hundreds, thousands, or millions of images?  Is there a good way of knowing what our dataset looks like without looking at their file names, or opening up each image one at a time?</p>
<p>One way we can do that is to randomly pick an image.</p>
<p>We’ve already seen how to read the image located at one of our file locations:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">plt.imread(files[<span class="number">0</span>])</div></pre></td></tr></table></figure>
<pre><code>array([[[253, 231, 194],
        [253, 231, 194],
        [253, 231, 194],
        ..., 
        [247, 226, 225],
        [254, 238, 222],
        [254, 238, 222]],

       [[253, 231, 194],
        [253, 231, 194],
        [253, 231, 194],
        ..., 
        [249, 228, 225],
        [254, 238, 222],
        [254, 238, 222]],

       [[253, 231, 194],
        [253, 231, 194],
        [253, 231, 194],
        ..., 
        [250, 231, 227],
        [255, 239, 223],
        [255, 239, 223]],

       ..., 
       [[140,  74,  26],
        [116,  48,   1],
        [146,  78,  33],
        ..., 
        [122,  55,  28],
        [122,  56,  30],
        [122,  56,  30]],

       [[130,  62,  15],
        [138,  70,  23],
        [166,  98,  53],
        ..., 
        [118,  49,  20],
        [118,  51,  24],
        [118,  51,  24]],

       [[168, 100,  53],
        [204, 136,  89],
        [245, 177, 132],
        ..., 
        [118,  49,  20],
        [120,  50,  24],
        [120,  50,  24]]], dtype=uint8)
</code></pre><p>to pick a random image from our list of files, we can use the numpy random module:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">print(np.random.randint(<span class="number">0</span>, len(files)))</div><div class="line">print(np.random.randint(<span class="number">0</span>, len(files)))</div><div class="line">print(np.random.randint(<span class="number">0</span>, len(files)))</div></pre></td></tr></table></figure>
<pre><code>5
8
4
</code></pre><p>This function will produce random integers between a range of values that we specify.  We say, give us random integers from 0 to the length of files.</p>
<p>We can now use the code we’ve written before to show a random image from our list of files:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">filename = files[np.random.randint(<span class="number">0</span>, len(files))]</div><div class="line">img = plt.imread(filename)</div><div class="line">plt.imshow(img)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f0ef93804d0&gt;
</code></pre><p><img src="output_59_1.png" alt="png"></p>
<p>This might be something useful that we’d like to do often.  So we can use a function to help us in the future:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_image</span><span class="params">(filename)</span>:</span></div><div class="line">    img = plt.imread(filename)</div><div class="line">    plt.imshow(img)</div></pre></td></tr></table></figure>
<p>This function takes one parameter, a variable named filename, which we will have to specify whenever we call it.  That variable is fed into the plt.imread function, and used to load an image.  It is then drawn with plt.imshow.  Let’s see how we can use this function definition:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">f = files[np.random.randint(<span class="number">0</span>, len(files))]</div><div class="line">plot_image(f)</div></pre></td></tr></table></figure>
<p><img src="output_63_0.png" alt="png"></p>
<p>or simply:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">plot_image(files[np.random.randint(<span class="number">0</span>, len(files))])</div></pre></td></tr></table></figure>
<p><img src="output_65_0.png" alt="png"></p>
<p>We use functions to help us reduce the main flow of our code.  It helps to make things clearer, using function names that help describe what is going on.</p>
<p><a name="image-manipulation"></a></p>
<h1 id="Image-Manipulation"><a href="#Image-Manipulation" class="headerlink" title="Image Manipulation"></a>Image Manipulation</h1><p><a name="cropping-images"></a></p>
<h2 id="Cropping-images"><a href="#Cropping-images" class="headerlink" title="Cropping images"></a>Cropping images</h2><p>We’re going to create another function which will help us crop the image to a standard size and help us draw every image in our list of files as a grid.</p>
<p>In many applications of deep learning, we will need all of our data to be the same size.  For images this means we’ll need to crop the images while trying not to remove any of the important information in it.  Most image datasets that you’ll find online will already have a standard size for every image.  But if you’re creating your own dataset, you’ll need to know how to make all the images the same size.  One way to do this is to find the longest edge of the image, and crop this edge to be as long as the shortest edge of the image.  This will convert the image to a square one, meaning its sides will be the same lengths.  The reason for doing this is that we can then resize this square image to any size we’d like, without distorting the image.  Let’s see how we can do that:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">imcrop_tosquare</span><span class="params">(img)</span>:</span></div><div class="line">    <span class="string">"""Make any image a square image.</span></div><div class="line"></div><div class="line">    Parameters</div><div class="line">    ----------</div><div class="line">    img : np.ndarray</div><div class="line">        Input image to crop, assumed at least 2d.</div><div class="line"></div><div class="line">    Returns</div><div class="line">    -------</div><div class="line">    crop : np.ndarray</div><div class="line">        Cropped image.</div><div class="line">    """</div><div class="line">    <span class="keyword">if</span> img.shape[<span class="number">0</span>] &gt; img.shape[<span class="number">1</span>]:</div><div class="line">        extra = (img.shape[<span class="number">0</span>] - img.shape[<span class="number">1</span>])</div><div class="line">        <span class="keyword">if</span> extra % <span class="number">2</span> == <span class="number">0</span>:</div><div class="line">            crop = img[extra // <span class="number">2</span>:-extra // <span class="number">2</span>, :]</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            crop = img[max(<span class="number">0</span>, extra // <span class="number">2</span> - <span class="number">1</span>):min(<span class="number">-1</span>, -extra // <span class="number">2</span>), :]</div><div class="line">    <span class="keyword">elif</span> img.shape[<span class="number">1</span>] &gt; img.shape[<span class="number">0</span>]:</div><div class="line">        extra = (img.shape[<span class="number">1</span>] - img.shape[<span class="number">0</span>])</div><div class="line">        <span class="keyword">if</span> extra % <span class="number">2</span> == <span class="number">0</span>:</div><div class="line">            crop = img[:, extra // <span class="number">2</span>:-extra // <span class="number">2</span>]</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            crop = img[:, max(<span class="number">0</span>, extra // <span class="number">2</span> - <span class="number">1</span>):min(<span class="number">-1</span>, -extra // <span class="number">2</span>)]</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        crop = img</div><div class="line">    <span class="keyword">return</span> crop</div></pre></td></tr></table></figure>
<p>There are a few things going on here.  First, we are defining a function which takes as input a single variable.  This variable gets named <code>img</code> inside the function, and we enter a set of if/else-if conditionals.  The first branch says, if the rows of <code>img</code> are greater than the columns, then set the variable <code>extra</code> to their difference and divide by 2.  The <code>//</code> notation means to perform an integer division, instead of a floating point division.  So <code>3 // 2 = 1</code>, not 1.5.  We need integers for the next line of code which says to set the variable <code>crop</code> to <code>img</code> starting from <code>extra</code> rows, and ending at negative <code>extra</code> rows down.  We can’t be on row 1.5, only row 1 or 2.  So that’s why we need the integer divide there.  Let’s say our image was 128 x 96 x 3.  We would have <code>extra = (128 - 96) // 2</code>, or 16.  Then we’d start from the 16th row, and end at the -16th row, or the 112th row.  That adds up to 96 rows, exactly the same number of columns as we have.</p>
<p>Let’s try another crop function which can crop by an arbitrary amount.  It will take an image and a single factor from 0-1, saying how much of the original image to crop:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">imcrop</span><span class="params">(img, amt)</span>:</span></div><div class="line">    <span class="keyword">if</span> amt &lt;= <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> img</div><div class="line">    row_i = int(img.shape[<span class="number">0</span>] * amt) // <span class="number">2</span></div><div class="line">    col_i = int(img.shape[<span class="number">1</span>] * amt) // <span class="number">2</span></div><div class="line">    <span class="keyword">return</span> img[row_i:-row_i, col_i:-col_i]</div></pre></td></tr></table></figure>
<p><a name="resizing-images"></a></p>
<h2 id="Resizing-images"><a href="#Resizing-images" class="headerlink" title="Resizing images"></a>Resizing images</h2><p>For resizing the image, we’ll make use of a python library, <code>scipy</code>.  Let’s import the function which we need like so:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment">#from scipy.&lt;tab&gt;misc import &lt;tab&gt;imresize</span></div></pre></td></tr></table></figure>
<p>Notice that you can hit tab after each step to see what is available. That is really helpful as I never remember what the exact names are.</p>
<figure class="highlight"><table><tr><td class="code"><pre><div class="line">from scipy.misc import imresize</div><div class="line">imresize?</div></pre></td></tr></table></figure>
<p>The <code>imresize</code> function takes a input image as its first parameter, and a tuple defining the new image shape as rows and then columns.</p>
<p>Let’s see how our cropped image can be imresized now:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">square = imcrop_tosquare(img)</div><div class="line">crop = imcrop(square, <span class="number">0.2</span>)</div><div class="line">rsz = imresize(crop, (<span class="number">64</span>, <span class="number">64</span>))</div><div class="line">plt.imshow(rsz)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f0ef2b8fdd0&gt;
</code></pre><p><img src="output_75_1.png" alt="png"></p>
<p>Great!  To really see what’s going on, let’s turn off the interpolation like so:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">plt.imshow(rsz, interpolation=<span class="string">'nearest'</span>)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f0ef2ad0c50&gt;
</code></pre><p><img src="output_77_1.png" alt="png"></p>
<p>Each one of these squares is called a pixel.  Since this is a color image, each pixel is actually a mixture of 3 values, Red, Green, and Blue.  When we mix those proportions of Red Green and Blue, we get the color shown here.</p>
<p>We can combine the Red Green and Blue channels by taking the mean, or averaging them.  This is equivalent to adding each channel, <code>R + G + B</code>, then dividing by the number of color channels, <code>(R + G + B) / 3</code>.   We can use the numpy.mean function to help us do this:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">mean_img = np.mean(rsz, axis=<span class="number">2</span>)</div><div class="line">print(mean_img.shape)</div><div class="line">plt.imshow(mean_img, cmap=<span class="string">'gray'</span>)</div></pre></td></tr></table></figure>
<pre><code>(64, 64)





&lt;matplotlib.image.AxesImage at 0x7f0ef2a1a490&gt;
</code></pre><p><img src="output_79_2.png" alt="png"></p>
<p>This is an incredibly useful function which we’ll revisit later when we try to visualize the mean image of our entire dataset.</p>
<p><a name="croppingresizing-images"></a></p>
<h2 id="Cropping-Resizing-Images"><a href="#Cropping-Resizing-Images" class="headerlink" title="Cropping/Resizing Images"></a>Cropping/Resizing Images</h2><p>We now have functions for cropping an image to a square image, and a function for resizing an image to any desired size.  With these tools, we can begin to create a dataset.  We’re going to loop over our 10 files, crop the image to a square to remove the longer edge, and then crop again to remove some of the background, and then finally resize the image to a standard size of 64 x 64 pixels.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">imgs = []</div><div class="line"><span class="keyword">for</span> file_i <span class="keyword">in</span> files:</div><div class="line">    img = plt.imread(file_i)</div><div class="line">    square = imcrop_tosquare(img)</div><div class="line">    crop = imcrop(square, <span class="number">0.2</span>)</div><div class="line">    rsz = imresize(crop, (<span class="number">64</span>, <span class="number">64</span>))</div><div class="line">    imgs.append(rsz)</div><div class="line">print(len(imgs))</div></pre></td></tr></table></figure>
<pre><code>10
</code></pre><p>We now have a list containing our images.  Each index of the <code>imgs</code> list is another image which we can access using the square brackets:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">plt.imshow(imgs[<span class="number">0</span>])</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f0ef29566d0&gt;
</code></pre><p><img src="output_83_1.png" alt="png"></p>
<p>Since all of the images are the same size, we can make use of numpy’s array instead of a list.</p>
<p>Remember that an image has a shape describing the height, width, channels:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">imgs[<span class="number">0</span>].shape</div></pre></td></tr></table></figure>
<pre><code>(64, 64, 3)
</code></pre><p><a name="the-batch-dimension"></a></p>
<h2 id="The-Batch-Dimension"><a href="#The-Batch-Dimension" class="headerlink" title="The Batch Dimension"></a>The Batch Dimension</h2><p>there is a convention for storing many images in an array using a new dimension called the batch dimension.  The resulting image shape should be:</p>
<p>N x H x W x C</p>
<p>The Number of images, or the batch size, is first; then the Height or number of rows in the image; then the Width or number of cols in the image; then finally the number of channels the image has.  A Color image should have 3 color channels, RGB.  A Grayscale image should just have 1 channel.</p>
<p>We can combine all of our images to look like this in a few ways.  The easiest way is to tell numpy to give us an array of all the images:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">data = np.array(imgs)</div><div class="line">data.shape</div></pre></td></tr></table></figure>
<pre><code>(10, 64, 64, 3)
</code></pre><p>We could also use the <code>numpy.concatenate</code> function, but we have to create a new dimension for each image.  Numpy let’s us do this by using a special variable <code>np.newaxis</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">data = np.concatenate([img_i[np.newaxis] <span class="keyword">for</span> img_i <span class="keyword">in</span> imgs], axis=<span class="number">0</span>)</div><div class="line">data.shape</div></pre></td></tr></table></figure>
<pre><code>(10, 64, 64, 3)
</code></pre><p>The shape is describing batch, or number of images, the height, or rows of the image, the width, or columns of the image, and finally, the number of channels in the image, describing the red, green, and blue colors of the image.</p>
<p>Try to remember at least one of these methods for building up your images as a large array as they can come in handy!</p>
<p><a name="conclusion"></a></p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>You’re now ready to move on to the first session where we will work with image datasets and start to compute interesting features of them.  Good luck!</p>

    
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/qrcode.jpg"
               alt="Feisky" />
          <p class="site-author-name" itemprop="name">Feisky</p>
          <p class="site-description motion-element" itemprop="description">Notes about anything.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">93</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/feiskyer" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/feisky" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/371069890" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/feisky/" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  博客园
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Preliminaries-with-Python-Notebook"><span class="nav-number">1.</span> <span class="nav-text">Preliminaries with Python/Notebook</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Learning-Goals"><span class="nav-number">2.</span> <span class="nav-text">Learning Goals</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Table-of-Contents"><span class="nav-number">3.</span> <span class="nav-text">Table of Contents</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">4.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Using-Notebook"><span class="nav-number">5.</span> <span class="nav-text">Using Notebook</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Cells"><span class="nav-number">5.1.</span> <span class="nav-text">Cells</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Kernel"><span class="nav-number">5.2.</span> <span class="nav-text">Kernel</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Importing-Libraries"><span class="nav-number">5.3.</span> <span class="nav-text">Importing Libraries</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Loading-Data"><span class="nav-number">6.</span> <span class="nav-text">Loading Data</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Structuring-data-as-folders"><span class="nav-number">6.1.</span> <span class="nav-text">Structuring data as folders</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Using-the-os-library-to-get-data"><span class="nav-number">6.2.</span> <span class="nav-text">Using the os library to get data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Loading-an-image"><span class="nav-number">6.3.</span> <span class="nav-text">Loading an image</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RGB-Image-Representation"><span class="nav-number">6.4.</span> <span class="nav-text">RGB Image Representation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Understanding-data-types-and-ranges-uint8-float32"><span class="nav-number">6.5.</span> <span class="nav-text">Understanding data types and ranges (uint8, float32)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Visualizing-your-data-as-images"><span class="nav-number">6.6.</span> <span class="nav-text">Visualizing your data as images</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Image-Manipulation"><span class="nav-number">7.</span> <span class="nav-text">Image Manipulation</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Cropping-images"><span class="nav-number">7.1.</span> <span class="nav-text">Cropping images</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Resizing-images"><span class="nav-number">7.2.</span> <span class="nav-text">Resizing images</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cropping-Resizing-Images"><span class="nav-number">7.3.</span> <span class="nav-text">Cropping/Resizing Images</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-Batch-Dimension"><span class="nav-number">7.4.</span> <span class="nav-text">The Batch Dimension</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conclusion"><span class="nav-number">8.</span> <span class="nav-text">Conclusion</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Feisky</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = decodeURIComponent(data.url);
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


  


</body>
</html>
