<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Cloud, Container, Kubernetes, SDN, Docker" />





  <link rel="alternate" href="/atom.xml" title="Feisky's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="Linear Regression using GraphlabFire up graphlab createimport graphlab
Load some house value vs. crime rate dataDataset is from Philadelphia, PA and includes average house sales price in a number of n">
<meta property="og:type" content="website">
<meta property="og:title" content="Feisky's Blog">
<meta property="og:url" content="http://feisky.xyz/ml/linear-regression/graphlab/index.html">
<meta property="og:site_name" content="Feisky's Blog">
<meta property="og:description" content="Linear Regression using GraphlabFire up graphlab createimport graphlab
Load some house value vs. crime rate dataDataset is from Philadelphia, PA and includes average house sales price in a number of n">
<meta property="og:image" content="http://feisky.xyz/output_13_1.png">
<meta property="og:image" content="http://feisky.xyz/output_22_1.png">
<meta property="og:updated_time" content="2016-11-18T00:02:29.953Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Feisky's Blog">
<meta name="twitter:description" content="Linear Regression using GraphlabFire up graphlab createimport graphlab
Load some house value vs. crime rate dataDataset is from Philadelphia, PA and includes average house sales price in a number of n">
<meta name="twitter:image" content="http://feisky.xyz/output_13_1.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://feisky.xyz/ml/linear-regression/graphlab/"/>


  <title>
  

  
     | Feisky's Blog
  
</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  


<!-- hexo-inject:begin --><!-- hexo-inject:end --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-69699206-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left  ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Feisky's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Notes about anything.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-pages">
          <a href="/pages" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            笔记
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
      <h1 id="Linear-Regression-using-Graphlab"><a href="#Linear-Regression-using-Graphlab" class="headerlink" title="Linear Regression using Graphlab"></a>Linear Regression using Graphlab</h1><h2 id="Fire-up-graphlab-create"><a href="#Fire-up-graphlab-create" class="headerlink" title="Fire up graphlab create"></a>Fire up graphlab create</h2><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> graphlab</div></pre></td></tr></table></figure>
<h2 id="Load-some-house-value-vs-crime-rate-data"><a href="#Load-some-house-value-vs-crime-rate-data" class="headerlink" title="Load some house value vs. crime rate data"></a>Load some house value vs. crime rate data</h2><p>Dataset is from Philadelphia, PA and includes average house sales price in a number of neighborhoods.  The attributes of each neighborhood we have include the crime rate (‘CrimeRate’), miles from Center City (‘MilesPhila’), town name (‘Name’), and county name (‘County’).</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">sales = graphlab.SFrame.read_csv(<span class="string">'Philadelphia_Crime_Rate_noNA.csv/'</span>)</div></pre></td></tr></table></figure>
<pre>Finished parsing file /Users/feisky/machine-learning/code/basic-classifiers/Philadelphia_Crime_Rate_noNA.csv</pre>



<pre>Parsing completed. Parsed 99 lines in 0.040707 secs.</pre>



<pre>Finished parsing file /Users/feisky/machine-learning/code/basic-classifiers/Philadelphia_Crime_Rate_noNA.csv</pre>



<pre>Parsing completed. Parsed 99 lines in 0.01334 secs.</pre>


<pre><code>------------------------------------------------------
Inferred types from first 100 line(s) of file as 
column_type_hints=[int,float,float,float,float,str,str]
If parsing fails due to incorrect types, you can correct
the inferred type list above and pass it to read_csv in
the column_type_hints argument
------------------------------------------------------
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">sales</div></pre></td></tr></table></figure>
<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">HousePrice</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">HsPrc ($10,000)</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">CrimeRate</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">MilesPhila</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">PopChg</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">Name</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">County</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">140463</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">14.0463</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">29.7</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">10.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">-1.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Abington</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Montgome</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">113033</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">11.3033</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">24.1</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">18.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Ambler</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Montgome</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">124186</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">12.4186</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">19.5</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">25.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">8.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Aston</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Delaware</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">110490</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">11.049</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">49.4</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">25.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2.7</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bensalem</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bucks</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">79124</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">7.9124</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">54.1</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">19.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3.9</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bristol B.</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bucks</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">92634</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">9.2634</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">48.6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">20.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bristol T.</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bucks</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">89246</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">8.9246</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">30.8</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">15.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">-2.6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Brookhaven</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Delaware</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">195145</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">19.5145</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">10.8</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">20.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">-3.5</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bryn Athyn</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Montgome</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">297342</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">29.7342</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">20.2</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">14.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bryn Mawr</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Montgome</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">264298</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">26.4298</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">20.4</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">26.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Buckingham</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Bucks</td>
    </tr>
</table>
[99 rows x 7 columns]<br>Note: Only the head of the SFrame is printed.<br>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</div>



<h1 id="Exploring-the-data"><a href="#Exploring-the-data" class="headerlink" title="Exploring the data"></a>Exploring the data</h1><p>The house price in a town is correlated with the crime rate of that town. Low crime towns tend to be associated with higher house prices and vice versa.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">graphlab.canvas.set_target(<span class="string">'ipynb'</span>)</div><div class="line">sales.show(view=<span class="string">"Scatter Plot"</span>, x=<span class="string">"CrimeRate"</span>, y=<span class="string">"HousePrice"</span>)</div></pre></td></tr></table></figure>
<h1 id="Fit-the-regression-model-using-crime-as-the-feature"><a href="#Fit-the-regression-model-using-crime-as-the-feature" class="headerlink" title="Fit the regression model using crime as the feature"></a>Fit the regression model using crime as the feature</h1><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">crime_model = graphlab.linear_regression.create(sales, target=<span class="string">'HousePrice'</span>, features=[<span class="string">'CrimeRate'</span>],validation_set=<span class="keyword">None</span>,verbose=<span class="keyword">False</span>)</div></pre></td></tr></table></figure>
<h1 id="Let’s-see-what-our-fit-looks-like"><a href="#Let’s-see-what-our-fit-looks-like" class="headerlink" title="Let’s see what our fit looks like"></a>Let’s see what our fit looks like</h1><p>Matplotlib is a Python plotting library that is also useful for plotting.  You can install it with:</p>
<p>‘pip install matplotlib’</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line">%matplotlib inline</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">plt.plot(sales[<span class="string">'CrimeRate'</span>],sales[<span class="string">'HousePrice'</span>],<span class="string">'.'</span>,</div><div class="line">        sales[<span class="string">'CrimeRate'</span>],crime_model.predict(sales),<span class="string">'-'</span>)</div></pre></td></tr></table></figure>
<pre><code>[&lt;matplotlib.lines.Line2D at 0x118f2d150&gt;,
 &lt;matplotlib.lines.Line2D at 0x118f2d390&gt;]
</code></pre><p><img src="output_13_1.png" alt="png"></p>
<p>Above: blue dots are original data, green line is the fit from the simple regression.</p>
<h1 id="Remove-Center-City-and-redo-the-analysis"><a href="#Remove-Center-City-and-redo-the-analysis" class="headerlink" title="Remove Center City and redo the analysis"></a>Remove Center City and redo the analysis</h1><p>Center City is the one observation with an extremely high crime rate, yet house prices are not very low.  This point does not follow the trend of the rest of the data very well.  A question is how much including Center City is influencing our fit on the other datapoints.  Let’s remove this datapoint and see what happens.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">sales_noCC = sales[sales[<span class="string">'MilesPhila'</span>] != <span class="number">0.0</span>]</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">sales_noCC.show(view=<span class="string">"Scatter Plot"</span>, x=<span class="string">"CrimeRate"</span>, y=<span class="string">"HousePrice"</span>)</div></pre></td></tr></table></figure>
<h3 id="Refit-our-simple-regression-model-on-this-modified-dataset"><a href="#Refit-our-simple-regression-model-on-this-modified-dataset" class="headerlink" title="Refit our simple regression model on this modified dataset:"></a>Refit our simple regression model on this modified dataset:</h3><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">crime_model_noCC = graphlab.linear_regression.create(sales_noCC, target=<span class="string">'HousePrice'</span>, features=[<span class="string">'CrimeRate'</span>],validation_set=<span class="keyword">None</span>, verbose=<span class="keyword">False</span>)</div></pre></td></tr></table></figure>
<h3 id="Look-at-the-fit"><a href="#Look-at-the-fit" class="headerlink" title="Look at the fit:"></a>Look at the fit:</h3><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">plt.plot(sales_noCC[<span class="string">'CrimeRate'</span>],sales_noCC[<span class="string">'HousePrice'</span>],<span class="string">'.'</span>,</div><div class="line">        sales_noCC[<span class="string">'CrimeRate'</span>],crime_model.predict(sales_noCC),<span class="string">'-'</span>)</div></pre></td></tr></table></figure>
<pre><code>[&lt;matplotlib.lines.Line2D at 0x1172d8050&gt;,
 &lt;matplotlib.lines.Line2D at 0x1172d8290&gt;]
</code></pre><p><img src="output_22_1.png" alt="png"></p>
<h1 id="Compare-coefficients-for-full-data-fit-versus-no-Center-City-fit"><a href="#Compare-coefficients-for-full-data-fit-versus-no-Center-City-fit" class="headerlink" title="Compare coefficients for full-data fit versus no-Center-City fit"></a>Compare coefficients for full-data fit versus no-Center-City fit</h1><p>Visually, the fit seems different, but let’s quantify this by examining the estimated coefficients of our original fit and that of the modified dataset with Center City removed.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">crime_model.get(<span class="string">'coefficients'</span>)</div></pre></td></tr></table></figure>
<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">name</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">index</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">value</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">stderr</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">(intercept)</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">176626.046881</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">11245.5882194</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">CrimeRate</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">-576.804949058</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">226.90225951</td>
    </tr>
</table>
[2 rows x 4 columns]<br>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">crime_model_noCC.get(<span class="string">'coefficients'</span>)</div></pre></td></tr></table></figure>
<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">name</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">index</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">value</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">stderr</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">(intercept)</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">225204.604303</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16404.0247514</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">CrimeRate</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">-2287.69717443</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">491.537478123</td>
    </tr>
</table>
[2 rows x 4 columns]<br>
</div>



<p>Above: We see that for the “no Center City” version, per unit increase in crime, the predicted decrease in house prices is 2,287.  In contrast, for the original dataset, the drop is only 576 per unit increase in crime.  This is significantly different!</p>
<h3 id="High-leverage-points"><a href="#High-leverage-points" class="headerlink" title="High leverage points:"></a>High leverage points:</h3><p>Center City is said to be a “high leverage” point because it is at an extreme x value where there are not other observations.  As a result, recalling the closed-form solution for simple regression, this point has the <em>potential</em> to dramatically change the least squares line since the center of x mass is heavily influenced by this one point and the least squares line will try to fit close to that outlying (in x) point.  If a high leverage point follows the trend of the other data, this might not have much effect.  On the other hand, if this point somehow differs, it can be strongly influential in the resulting fit.</p>
<h3 id="Influential-observations"><a href="#Influential-observations" class="headerlink" title="Influential observations:"></a>Influential observations:</h3><p>An influential observation is one where the removal of the point significantly changes the fit.  As discussed above, high leverage points are good candidates for being influential observations, but need not be.  Other observations that are <em>not</em> leverage points can also be influential observations (e.g., strongly outlying in y even if x is a typical value).</p>
<h1 id="Remove-high-value-outlier-neighborhoods-and-redo-analysis"><a href="#Remove-high-value-outlier-neighborhoods-and-redo-analysis" class="headerlink" title="Remove high-value outlier neighborhoods and redo analysis"></a>Remove high-value outlier neighborhoods and redo analysis</h1><p>Based on the discussion above, a question is whether the outlying high-value towns are strongly influencing the fit.  Let’s remove them and see what happens.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">sales_nohighend = sales_noCC[sales_noCC[<span class="string">'HousePrice'</span>] &lt; <span class="number">350000</span>] </div><div class="line">crime_model_nohighend = graphlab.linear_regression.create(sales_nohighend, target=<span class="string">'HousePrice'</span>, features=[<span class="string">'CrimeRate'</span>],validation_set=<span class="keyword">None</span>, verbose=<span class="keyword">False</span>)</div></pre></td></tr></table></figure>
<h3 id="Do-the-coefficients-change-much"><a href="#Do-the-coefficients-change-much" class="headerlink" title="Do the coefficients change much?"></a>Do the coefficients change much?</h3><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">crime_model_noCC.get(<span class="string">'coefficients'</span>)</div></pre></td></tr></table></figure>
<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">name</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">index</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">value</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">stderr</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">(intercept)</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">225204.604303</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16404.0247514</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">CrimeRate</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">-2287.69717443</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">491.537478123</td>
    </tr>
</table>
[2 rows x 4 columns]<br>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><div class="line">crime_model_nohighend.get(<span class="string">'coefficients'</span>)</div></pre></td></tr></table></figure>
<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">name</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">index</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">value</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">stderr</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">(intercept)</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">199073.589615</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">11932.5101105</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">CrimeRate</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">-1837.71280989</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">351.519609333</td>
    </tr>
</table>
[2 rows x 4 columns]<br>
</div>



<p>Above: We see that removing the outlying high-value neighborhoods has <em>some</em> effect on the fit, but not nearly as much as our high-leverage Center City datapoint.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>

    
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/qrcode.jpg"
               alt="Feisky" />
          <p class="site-author-name" itemprop="name">Feisky</p>
          <p class="site-description motion-element" itemprop="description">Notes about anything.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">90</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/feiskyer" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/feisky" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/371069890" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/feisky/" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  博客园
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Linear-Regression-using-Graphlab"><span class="nav-number">1.</span> <span class="nav-text">Linear Regression using Graphlab</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Fire-up-graphlab-create"><span class="nav-number">1.1.</span> <span class="nav-text">Fire up graphlab create</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Load-some-house-value-vs-crime-rate-data"><span class="nav-number">1.2.</span> <span class="nav-text">Load some house value vs. crime rate data</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Exploring-the-data"><span class="nav-number">2.</span> <span class="nav-text">Exploring the data</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fit-the-regression-model-using-crime-as-the-feature"><span class="nav-number">3.</span> <span class="nav-text">Fit the regression model using crime as the feature</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Let’s-see-what-our-fit-looks-like"><span class="nav-number">4.</span> <span class="nav-text">Let’s see what our fit looks like</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Remove-Center-City-and-redo-the-analysis"><span class="nav-number">5.</span> <span class="nav-text">Remove Center City and redo the analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Refit-our-simple-regression-model-on-this-modified-dataset"><span class="nav-number">5.0.1.</span> <span class="nav-text">Refit our simple regression model on this modified dataset:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Look-at-the-fit"><span class="nav-number">5.0.2.</span> <span class="nav-text">Look at the fit:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Compare-coefficients-for-full-data-fit-versus-no-Center-City-fit"><span class="nav-number">6.</span> <span class="nav-text">Compare coefficients for full-data fit versus no-Center-City fit</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#High-leverage-points"><span class="nav-number">6.0.1.</span> <span class="nav-text">High leverage points:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Influential-observations"><span class="nav-number">6.0.2.</span> <span class="nav-text">Influential observations:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Remove-high-value-outlier-neighborhoods-and-redo-analysis"><span class="nav-number">7.</span> <span class="nav-text">Remove high-value outlier neighborhoods and redo analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Do-the-coefficients-change-much"><span class="nav-number">7.0.1.</span> <span class="nav-text">Do the coefficients change much?</span></a></li></ol></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Feisky</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = decodeURIComponent(data.url);
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


  


</body>
</html>
