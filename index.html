<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Cloud, Container, Kubernetes, SDN, Docker" />





  <link rel="alternate" href="/atom.xml" title="Feisky's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="Notes about anything.">
<meta property="og:type" content="website">
<meta property="og:title" content="Feisky's Blog">
<meta property="og:url" content="http://feisky.xyz/index.html">
<meta property="og:site_name" content="Feisky's Blog">
<meta property="og:description" content="Notes about anything.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Feisky's Blog">
<meta name="twitter:description" content="Notes about anything.">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    }
  };
</script>




  <link rel="canonical" href="http://feisky.xyz/"/>


  <title> Feisky's Blog </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  


<!-- hexo-inject:begin --><!-- hexo-inject:end --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-69699206-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Feisky's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Notes about anything.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-pages">
          <a href="/pages" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            ç¬”è®°
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            å…¬ç›Š404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/13/Kubernetes-v1-5-0-release/" itemprop="url">
                  Kubernetes v1.5.0 release
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-12-13T11:51:29+08:00" content="2016-12-13">
              2016-12-13
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>Update on 2016.12.14:</strong></p>
<p>Due to a serious security problem, kubernetes v1.5.0 is not recommanded. Kubernetes v1.5.1 has just released, so we should upgrade to v1.5.1 directly.</p>
<blockquote>
<p>The <code>--anonymous-auth=</code> flag in v1.5.0 is true by default (which may result in any users being able to access kubernetes API), but v1.5.1 turns it to false.</p>
</blockquote>
<h2 id="Kubernetes-v1-5-0"><a href="#Kubernetes-v1-5-0" class="headerlink" title="Kubernetes v1.5.0"></a>Kubernetes v1.5.0</h2><ul>
<li>StatefulSets (ex-PetSets)<ul>
<li>StatefulSets are beta now (fixes and stabilization)</li>
</ul>
</li>
<li>Improved Federation Support<ul>
<li>New command: <code>kubefed</code></li>
<li>DaemonSets</li>
<li>Deployments</li>
<li>ConfigMaps</li>
</ul>
</li>
<li>Simplified Cluster Deployment<ul>
<li>Improvements to <code>kubeadm</code></li>
<li>HA Setup for Master</li>
</ul>
</li>
<li>Node Robustness and Extensibility<ul>
<li>Windows Server Container support</li>
<li>CRI for pluggable container runtimes</li>
<li><code>kubelet</code> API supports authentication and authorization</li>
</ul>
</li>
</ul>
<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><p>Features for this release were tracked via the use of the <a href="https://github.com/kubernetes/features" target="_blank" rel="external">kubernetes/features</a> issues repo.  Each Feature issue is owned by a Special Interest Group from <a href="https://github.com/kubernetes/community" target="_blank" rel="external">kubernetes/community</a></p>
<ul>
<li><strong>API Machinery</strong><ul>
<li>[beta] <code>kube-apiserver</code> support for the OpenAPI spec is moving from alpha to beta. The first <a href="https://github.com/kubernetes-incubator/client-python" target="_blank" rel="external">non-go client</a> is based on it (<a href="https://github.com/kubernetes/features/issues/53" target="_blank" rel="external">kubernetes/features#53</a>)</li>
</ul>
</li>
<li><strong>Apps</strong><ul>
<li>[stable] When replica sets cannot create pods, they will now report detail via the API about the underlying reason (<a href="https://github.com/kubernetes/features/issues/120" target="_blank" rel="external">kubernetes/features#120</a>)</li>
<li>[stable] <code>kubectl apply</code> is now able to delete resources you no longer need with <code>--prune</code> (<a href="https://github.com/kubernetes/features/issues/128" target="_blank" rel="external">kubernetes/features#128</a>)</li>
<li>[beta] Deployments that cannot make progress in rolling out the newest version will now indicate via the API they are blocked (<a href="http://kubernetes.io/docs/user-guide/deployments/#failed-deployment" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/122" target="_blank" rel="external">kubernetes/features#122</a>)</li>
<li>[beta] StatefulSets allow workloads that require persistent identity or per-instance storage to be created and managed on Kubernetes. (<a href="http://kubernetes.io/docs/concepts/abstractions/controllers/statefulsets/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/137" target="_blank" rel="external">kubernetes/features#137</a>)</li>
<li>[beta] In order to preserve safety guarantees the cluster no longer force deletes pods on un-responsive nodes and users are now warned if they try to force delete pods via the CLI. (<a href="http://kubernetes.io/docs/tasks/manage-stateful-set/scale-stateful-set/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/119" target="_blank" rel="external">kubernetes/features#119</a>)</li>
</ul>
</li>
<li><strong>Auth</strong><ul>
<li>[alpha] Further polishing of the Role-based access control alpha API including a default set of cluster roles. (<a href="http://kubernetes.io/docs/admin/authorization/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/2" target="_blank" rel="external">kubernetes/features#2</a>)</li>
<li>[beta] Added ability to authenticate/authorize access to the Kubelet API (<a href="http://kubernetes.io/docs/admin/kubelet-authentication-authorization/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/89" target="_blank" rel="external">kubernetes/features#89</a>)</li>
</ul>
</li>
<li><strong>AWS</strong><ul>
<li>[stable] Roles should appear in kubectl get nodes (<a href="https://github.com/kubernetes/features/issues/113" target="_blank" rel="external">kubernetes/features#113</a>)</li>
</ul>
</li>
<li><strong>Cluster Lifecycle</strong><ul>
<li>[alpha] Improved UX and usability for the kubeadm binary that makes it easy to get a new cluster running. (<a href="http://kubernetes.io/docs/getting-started-guides/kubeadm/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/11" target="_blank" rel="external">kubernetes/features#11</a>)</li>
</ul>
</li>
<li><strong>Cluster Ops</strong><ul>
<li>[alpha] Added ability to create/remove clusters w/highly available (replicated) masters on GCE using kube-up/kube-down scripts. (<a href="http://kubernetes.io/docs/admin/ha-master-gce/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/48" target="_blank" rel="external">kubernetes/features#48</a>)</li>
</ul>
</li>
<li><strong>Federation</strong><ul>
<li>[alpha] Support for ConfigMaps in federation. (<a href="http://kubernetes.io/docs/user-guide/federation/configmap/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/105" target="_blank" rel="external">kubernetes/features#105</a>)</li>
<li>[alpha] Alpha level support for DaemonSets in federation. (<a href="http://kubernetes.io/docs/user-guide/federation/daemonsets/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/101" target="_blank" rel="external">kubernetes/features#101</a>)</li>
<li>[alpha] Alpha level support for Deployments in federation. (<a href="http://kubernetes.io/docs/user-guide/federation/deployment/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/100" target="_blank" rel="external">kubernetes/features#100</a>)</li>
<li>[alpha] Cluster federation: Added support for DeleteOptions.OrphanDependents for federation resources. (<a href="http://kubernetes.io/docs/user-guide/federation/#cascading-deletion" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/99" target="_blank" rel="external">kubernetes/features#99</a>)</li>
<li>[alpha] Introducing <code>kubefed</code>, a new command line tool to simplify federation control plane kubernetes.io/docs/admin/federation/kubefed/)) (<a href="https://github.com/kubernetes/features/issues/97" target="_blank" rel="external">kubernetes/features#97</a>)</li>
</ul>
</li>
<li><strong>Network</strong><ul>
<li>[stable] Services can reference another service by DNS name, rather than being hosted in pods (<a href="https://github.com/kubernetes/features/issues/33" target="_blank" rel="external">kubernetes/features#33</a>)</li>
<li>[beta] Opt in source ip preservation for Services with Type NodePort or LoadBalancer (<a href="http://kubernetes.io/docs/tutorials/services/source-ip/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/27" target="_blank" rel="external">kubernetes/features#27</a>)</li>
<li>[stable] Enable DNS Horizontal Autoscaling with beta ConfigMap parameters support (<a href="http://kubernetes.io/docs/tasks/administer-cluster/dns-horizontal-autoscaling/" target="_blank" rel="external">docs</a>)</li>
</ul>
</li>
<li><strong>Node</strong><ul>
<li>[alpha] Added ability to preserve access to host userns when userns remapping is enabled in container runtime (<a href="https://github.com/kubernetes/features/issues/127" target="_blank" rel="external">kubernetes/features#127</a>)</li>
<li>[alpha] Introducing the v1alpha1 CRI API to allow pluggable container runtimes; an experimental docker-CRI integration is ready for testing and feedback. (<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/container-runtime-interface.md" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/54" target="_blank" rel="external">kubernetes/features#54</a>)</li>
<li>[alpha] Kubelet launches container in a per pod cgroup hiearchy based on quality of service tier (<a href="https://github.com/kubernetes/features/issues/126" target="_blank" rel="external">kubernetes/features#126</a>)</li>
<li>[beta] Kubelet integrates with memcg notification API to detect when a hard eviction threshold is crossed (<a href="https://github.com/kubernetes/features/issues/125" target="_blank" rel="external">kubernetes/features#125</a>)</li>
<li>[beta] Introducing the beta version containerized node conformance test gcr.io/google_containers/node-test:0.2 for users to verify node setup. (<a href="http://kubernetes.io/docs/admin/node-conformance/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/84" target="_blank" rel="external">kubernetes/features#84</a>)</li>
</ul>
</li>
<li><strong>Scheduling</strong><ul>
<li>[alpha] Added support for accounting opaque integer resources. (<a href="http://kubernetes.io/docs/user-guide/compute-resources/#opaque-integer-resources-alpha-feature" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/76" target="_blank" rel="external">kubernetes/features#76</a>)</li>
<li>[beta] PodDisruptionBudget has been promoted to beta, can be used to safely drain nodes while respecting application SLOâ€™s (<a href="http://kubernetes.io/docs/tasks/administer-cluster/safely-drain-node/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/85" target="_blank" rel="external">kubernetes/features#85</a>)</li>
</ul>
</li>
<li><strong>UI</strong><ul>
<li>[stable] Dashboard UI now shows all user facing objects and their resource usage. (<a href="http://kubernetes.io/docs/user-guide/ui/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/136" target="_blank" rel="external">kubernetes/features#136</a>)</li>
</ul>
</li>
<li><strong>Windows</strong><ul>
<li>[alpha] Added support for Windows Server 2016 nodes and scheduling Windows Server Containers (<a href="http://kubernetes.io/docs/getting-started-guides/windows/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/features/issues/116" target="_blank" rel="external">kubernetes/features#116</a>)</li>
</ul>
</li>
</ul>
<h2 id="Known-Issues"><a href="#Known-Issues" class="headerlink" title="Known Issues"></a>Known Issues</h2><p>Populated via <a href="https://github.com/kubernetes/kubernetes/issues/37134" target="_blank" rel="external">v1.5.0 known issues / FAQ accumulator</a></p>
<ul>
<li>CRI <a href="https://github.com/kubernetes/community/blob/master/contributors/devel/container-runtime-interface.md#kubernetes-v15-release-cri-v1alpha1" target="_blank" rel="external">known issues and<br>limitations</a></li>
<li>getDeviceNameFromMount() function doesnâ€™t return the volume path correctly when the volume path contains spaces <a href="https://github.com/kubernetes/kubernetes/issues/37712" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/37712" target="_blank" rel="external">#37712</a></a></li>
<li>Federation alpha features do not have feature gates defined and<br>are hence enabled by default. This will be fixed in a future release.<br><a href="https://github.com/kubernetes/kubernetes/issues/38593" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/38593" target="_blank" rel="external">#38593</a></a></li>
<li>Federation control plane can be upgraded by updating the image<br>fields in the <code>Deployment</code> specs of the control plane components.<br>However, federation control plane upgrades were not tested in this<br>release <a href="https://github.com/kubernetes/kubernetes/issues/38537" target="_blank" rel="external">38537</a></li>
</ul>
<h2 id="Notable-Changes-to-Existing-Behavior"><a href="#Notable-Changes-to-Existing-Behavior" class="headerlink" title="Notable Changes to Existing Behavior"></a>Notable Changes to Existing Behavior</h2><ul>
<li>Node controller no longer force-deletes pods from the api-server. (<a href="https://github.com/kubernetes/kubernetes/pull/35235" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/35235" target="_blank" rel="external">#35235</a></a>, <a href="https://github.com/foxish" target="_blank" rel="external"><a href="https://github.com/foxish" target="_blank" rel="external">@foxish</a></a>)<ul>
<li>For StatefulSet (previously PetSet), this change means creation of<br>replacement pods is blocked until old pods are definitely not running<br>(indicated either by the kubelet returning from partitioned state,<br>deletion of the Node object, deletion of the instance in the cloud provider,<br>or force deletion of the pod from the api-server).<br>This helps prevent â€œsplit brainâ€ scenarios in clustered applications by<br>ensuring that unreachable pods will not be presumed dead unless some<br>â€œfencingâ€ operation has provided one of the above indications.</li>
<li>For all other existing controllers except StatefulSet, this has no effect on<br>the ability of the controller to replace pods because the controllers do not<br>reuse pod names (they use generate-name).</li>
<li>User-written controllers that reuse names of pod objects should evaluate this change.</li>
<li>When deleting an object with <code>kubectl delete ... --grace-period=0</code>, the client will<br>begin a graceful deletion and wait until the resource is fully deleted.  To force<br>deletion immediately, use the <code>--force</code> flag. This prevents users from accidentally<br>allowing two Stateful Set pods to share the same persistent volume which could lead to data<br>corruption <a href="https://github.com/kubernetes/kubernetes/pull/37263" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/37263" target="_blank" rel="external">#37263</a></a></li>
</ul>
</li>
</ul>
<ul>
<li><p>Allow anonymous API server access, decorate authenticated users with system:authenticated group (<a href="https://github.com/kubernetes/kubernetes/pull/32386" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/32386" target="_blank" rel="external">#32386</a></a>, <a href="https://github.com/liggitt" target="_blank" rel="external"><a href="https://github.com/liggitt" target="_blank" rel="external">@liggitt</a></a>)</p>
<ul>
<li>kube-apiserver learned the â€˜â€”anonymous-authâ€™ flag, which defaults to true. When enabled, requests to the secure port that are not rejected by other configured authentication methods are treated as anonymous requests, and given a username of â€˜system:anonymousâ€™ and a group of â€˜system:unauthenticatedâ€™.</li>
<li>Authenticated users are decorated with a â€˜system:authenticatedâ€™ group.</li>
<li>NOTE: anonymous access is enabled by default. If you rely on authentication alone to authorize access, change to use an authorization mode other than AlwaysAllow, or or set â€˜â€”anonymous-auth=falseâ€™.</li>
</ul>
</li>
<li><p>kubectl get -o jsonpath=â€¦ will now throw an error if the path is to a field not present in the json, even if the path is for a field valid for the type.  This is a change from the pre-1.5 behavior, which would return the default value for some fields even if they were not present in the json. (<a href="https://github.com/kubernetes/kubernetes/issues/37991" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/37991" target="_blank" rel="external">#37991</a></a>, <a href="http://github.com/pwittrock" target="_blank" rel="external"><a href="https://github.com/pwittrock" target="_blank" rel="external">@pwittrock</a></a>)</p>
</li>
<li><p>The strategicmerge patchMergeKey for VolumeMounts was changed from â€œnameâ€ to â€œmountPathâ€.  This was necessary because the name field refers to the name of the Volume, and is not a unique key for the VolumeMount.  Multiple VolumeMounts will have the same Volume name if mounting the same volume more than once.  The â€œmountPathâ€ is verified to be unique and can act as the mergekey.  (<a href="https://github.coma/kubernetes/kubernetes/pull/35071" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/35071" target="_blank" rel="external">#35071</a></a>, <a href="http://github.com/pwittrock" target="_blank" rel="external"><a href="https://github.com/pwittrock" target="_blank" rel="external">@pwittrock</a></a>)</p>
</li>
</ul>
<h2 id="Deprecations"><a href="#Deprecations" class="headerlink" title="Deprecations"></a>Deprecations</h2><ul>
<li>extensions/v1beta1.Jobs is deprecated, use batch/v1.Job instead (<a href="https://github.com/kubernetes/kubernetes/pull/36355" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/36355" target="_blank" rel="external">#36355</a></a>, <a href="https://github.com/soltysh" target="_blank" rel="external"><a href="https://github.com/soltysh" target="_blank" rel="external">@soltysh</a></a>)</li>
<li>The kubelet â€”reconcile-cdir flag is deprecated because it has no function anymore. (<a href="https://github.com/kubernetes/kubernetes/pull/35523" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/35523" target="_blank" rel="external">#35523</a></a>, <a href="https://github.com/luxas" target="_blank" rel="external"><a href="https://github.com/luxas" target="_blank" rel="external">@luxas</a></a>)</li>
<li>Notice of deprecation for recycler <a href="https://github.com/kubernetes/kubernetes/pull/36760" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/36760" target="_blank" rel="external">#36760</a></a></li>
</ul>
<h2 id="Action-Required-Before-Upgrading"><a href="#Action-Required-Before-Upgrading" class="headerlink" title="Action Required Before Upgrading"></a>Action Required Before Upgrading</h2><ul>
<li>batch/v2alpha1.ScheduledJob has been renamed, use batch/v2alpha1.CronJob instead (<a href="https://github.com/kubernetes/kubernetes/pull/36021" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/36021" target="_blank" rel="external">#36021</a></a>, <a href="https://github.com/soltysh" target="_blank" rel="external"><a href="https://github.com/soltysh" target="_blank" rel="external">@soltysh</a></a>)</li>
<li>PetSet has been renamed to StatefulSet.<br>If you have existing PetSets, <strong>you must perform extra migration steps</strong> both<br>before and after upgrading to convert them to StatefulSets. (<a href="http://kubernetes.io/docs/tasks/manage-stateful-set/upgrade-pet-set-to-stateful-set/" target="_blank" rel="external">docs</a>) (<a href="https://github.com/kubernetes/kubernetes/pull/35663" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/35663" target="_blank" rel="external">#35663</a></a>, <a href="https://github.com/janetkuo" target="_blank" rel="external"><a href="https://github.com/janetkuo" target="_blank" rel="external">@janetkuo</a></a>)</li>
<li>If you are upgrading your Cluster Federation components from v1.4.x, please update your <code>federation-apiserver</code> and <code>federation-controller-manager</code> manifests to the new version (<a href="https://github.com/kubernetes/kubernetes/pull/30601" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/30601" target="_blank" rel="external">#30601</a></a>, <a href="https://github.com/madhusudancs" target="_blank" rel="external"><a href="https://github.com/madhusudancs" target="_blank" rel="external">@madhusudancs</a></a>)</li>
<li>The deprecated kubelet â€”configure-cbr0 flag has been removed, and with that the â€œclassicâ€ networking mode as well.  If you depend on this mode, please investigate whether the other network plugins <code>kubenet</code> or <code>cni</code> meet your needs. (<a href="https://github.com/kubernetes/kubernetes/pull/34906" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/34906" target="_blank" rel="external">#34906</a></a>, <a href="https://github.com/luxas" target="_blank" rel="external"><a href="https://github.com/luxas" target="_blank" rel="external">@luxas</a></a>)</li>
<li>New client-go structure, refer to kubernetes/client-go for versioning policy (<a href="https://github.com/kubernetes/kubernetes/pull/34989" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/34989" target="_blank" rel="external">#34989</a></a>, <a href="https://github.com/caesarxuchao" target="_blank" rel="external"><a href="https://github.com/caesarxuchao" target="_blank" rel="external">@caesarxuchao</a></a>)</li>
<li>The deprecated kube-scheduler â€”bind-pods-qps and â€”bind-pods burst flags have been removed, use â€”kube-api-qps and â€”kube-api-burst instead (<a href="https://github.com/kubernetes/kubernetes/pull/34471" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/34471" target="_blank" rel="external">#34471</a></a>, <a href="https://github.com/timothysc" target="_blank" rel="external"><a href="https://github.com/timothysc" target="_blank" rel="external">@timothysc</a></a>)</li>
<li>If you used the <a href="http://kubernetes.io/docs/admin/disruptions/" target="_blank" rel="external">PodDisruptionBudget</a> feature in 1.4 (i.e. created <code>PodDisruptionBudget</code> objects), then <strong>BEFORE</strong>  upgrading from 1.4 to 1.5, you must delete all <code>PodDisruptionBudget</code> objects (<code>policy/v1alpha1/PodDisruptionBudget</code>) that you have created. It is not possible to delete these objects after you upgrade, and their presence will prevent you from using the beta PodDisruptionBudget feature in 1.5 (which uses <code>policy/v1beta1/PodDisruptionBudget</code>). If you have already upgraded, you will need to downgrade the master to 1.4 to delete the <code>policy/v1alpha1/PodDisruptionBudget</code> objects.</li>
</ul>
<h2 id="External-Dependency-Version-Information"><a href="#External-Dependency-Version-Information" class="headerlink" title="External Dependency Version Information"></a>External Dependency Version Information</h2><p>Continuous integration builds have used the following versions of external dependencies, however, this is not a strong recommendation and users should consult an appropriate installation or upgrade guide before deciding what versions of etcd, docker or rkt to use.</p>
<ul>
<li>Docker versions 1.10.3 - 1.12.3<ul>
<li>Docker version 1.11.2 known issues<ul>
<li>Kernel crash with Aufs storage driver on Debian Jessie (<a href="https://github.com/kubernetes/kubernetes/issues/27885" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/27885" target="_blank" rel="external">#27885</a></a>)<br>which can be identified by the <a href="http://kubernetes.io/docs/admin/node-problem/" target="_blank" rel="external">node problem detector</a></li>
<li>Leaked File descriptors (<a href="https://github.com/docker/containerd/issues/275" target="_blank" rel="external">#275</a>)</li>
<li>Additional memory overhead per container (<a href="https://github.com/docker/docker/issues/21737" target="_blank" rel="external"><a href="https://github.com/kubernetes/kubernetes/pull/21737" target="_blank" rel="external">#21737</a></a>)</li>
</ul>
</li>
<li>Docker version 1.12.1 <a href="https://github.com/kubernetes/kubernetes/issues/28698" target="_blank" rel="external">has been validated</a> through the Kubernetes docker automated validation framework as has Docker version 1.12.3</li>
<li>Docker 1.10.3 contains <a href="https://github.com/docker/docker/compare/v1.10.3...runcom:docker-1.10.3-stable" target="_blank" rel="external">backports provided by RedHat</a> for known issues</li>
<li>Docker versions as old as may 1.9.1 work with <a href="CHANGELOG.md#191">known issues</a> but this is not guaranteed</li>
</ul>
</li>
<li>rkt version 1.21.0<ul>
<li>known issues with the rkt runtime are <a href="http://kubernetes.io/docs/getting-started-guides/rkt/notes/" target="_blank" rel="external">listed here</a></li>
</ul>
</li>
<li><p>etcd version 2.2.1</p>
<ul>
<li>etcd version 3.0.14 <a href="https://k8s-gubernator.appspot.com/builds/kubernetes-jenkins/logs/ci-kubernetes-e2e-gce-etcd3/" target="_blank" rel="external">has also been validated</a> but does require <a href="https://coreos.com/blog/migrating-applications-etcd-v3.html" target="_blank" rel="external">specific configuration steps</a></li>
</ul>
<p><a href="https://docs.k8s.io" target="_blank" rel="external">Documentation</a> &amp; <a href="https://releases.k8s.io/release-1.5/examples" target="_blank" rel="external">Examples</a></p>
<h2 id="Downloads-for-v1-5-0"><a href="#Downloads-for-v1-5-0" class="headerlink" title="Downloads for v1.5.0"></a>Downloads for v1.5.0</h2></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>filename</th>
<th>sha256 hash</th>
</tr>
</thead>
<tbody>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes.tar.gz" target="_blank" rel="external">kubernetes.tar.gz</a></td>
<td><code>52b7df98ea05fb3ebbababf1ccb7f6d4e6f4cad00b8d09350f270aa7e3ad7e85</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-src.tar.gz" target="_blank" rel="external">kubernetes-src.tar.gz</a></td>
<td><code>fbefb2544667f96045c346cee595b0f315282dfdbd41a8f2d5ccc74054a4078e</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Client-Binaries"><a href="#Client-Binaries" class="headerlink" title="Client Binaries"></a>Client Binaries</h3><div class="table-container">
<table>
<thead>
<tr>
<th>filename</th>
<th>sha256 hash</th>
</tr>
</thead>
<tbody>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-client-darwin-386.tar.gz" target="_blank" rel="external">kubernetes-client-darwin-386.tar.gz</a></td>
<td><code>27d71bb6b16a26387ee30272bd4ee5758deccafafdc91b38f3d0dc19a34e129e</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-client-darwin-amd64.tar.gz" target="_blank" rel="external">kubernetes-client-darwin-amd64.tar.gz</a></td>
<td><code>5fa8550235919568d7d839b19de00e9bdd72a97cfde21dbdbe07fefd6d6290dc</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-client-linux-386.tar.gz" target="_blank" rel="external">kubernetes-client-linux-386.tar.gz</a></td>
<td><code>032a17701c014b8bbbb83c7da1046d8992a41031628cf7e1959a94378f5f195b</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-client-linux-amd64.tar.gz" target="_blank" rel="external">kubernetes-client-linux-amd64.tar.gz</a></td>
<td><code>afae4fadb7bbb1532967f88fef1de6458abda17219f634cc2c41608fd83ae7f6</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-client-linux-arm64.tar.gz" target="_blank" rel="external">kubernetes-client-linux-arm64.tar.gz</a></td>
<td><code>acca7607dae678a0165b7e10685e0eff0d418beebe7c25eaffe18c85717b5cc4</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-client-linux-arm.tar.gz" target="_blank" rel="external">kubernetes-client-linux-arm.tar.gz</a></td>
<td><code>fbc182b6d9ae476c7c509486d773074fd1007032886a8177735e08010c43f89d</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-client-windows-386.tar.gz" target="_blank" rel="external">kubernetes-client-windows-386.tar.gz</a></td>
<td><code>a8ddea329bc8d57267294464c163d8c2f7837f6353f8c685271864ed8b8bc54d</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-client-windows-amd64.tar.gz" target="_blank" rel="external">kubernetes-client-windows-amd64.tar.gz</a></td>
<td><code>bc3a76f1414fa1f4b2fb92732de2100d346edb7b870ed5414ea062bb401a8ebd</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Server-Binaries"><a href="#Server-Binaries" class="headerlink" title="Server Binaries"></a>Server Binaries</h3><div class="table-container">
<table>
<thead>
<tr>
<th>filename</th>
<th>sha256 hash</th>
</tr>
</thead>
<tbody>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-server-linux-amd64.tar.gz" target="_blank" rel="external">kubernetes-server-linux-amd64.tar.gz</a></td>
<td><code>b9c122d709c0556c1e19d31d98bf26ee530f91c0119f4454fb930cef5a0c1aa7</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-server-linux-arm64.tar.gz" target="_blank" rel="external">kubernetes-server-linux-arm64.tar.gz</a></td>
<td><code>3bbba5c8dedc47db8f9ebdfac5468398cce2470617de9d550affef9702b724c9</code></td>
</tr>
<tr>
<td>  <a href="https://dl.k8s.io/v1.5.0/kubernetes-server-linux-arm.tar.gz" target="_blank" rel="external">kubernetes-server-linux-arm.tar.gz</a></td>
<td><code>3ff9ccdd641690fd1c8878408cd369beca1f9f8b212198e251862d40cf2dadc0</code></td>
</tr>
</tbody>
</table>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/08/Weekly-reading-list/" itemprop="url">
                  Weekly reading list
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-12-08T14:00:22+08:00" content="2016-12-08">
              2016-12-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Readings/" itemprop="url" rel="index">
                    <span itemprop="name">Readings</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Dockeræ”¶è´­Infinit-PDF"><a href="#Dockeræ”¶è´­Infinit-PDF" class="headerlink" title="Dockeræ”¶è´­Infinit PDF"></a><a href="https://blog.docker.com/2016/12/docker-acquires-infinit/" target="_blank" rel="external">Dockeræ”¶è´­Infinit</a> <a href="/assets/infinit.pdf">PDF</a></h1><p><a href="https://infinit.sh/" target="_blank" rel="external">Infinit</a>ä¸ºå®¹å™¨æä¾›äº†åˆ†å¸ƒå¼å­˜å‚¨ï¼Œå…¶ç‰¹ç‚¹åŒ…æ‹¬</p>
<ul>
<li>åŸºäºè½¯ä»¶ï¼šå¯ä»¥éƒ¨ç½²åœ¨ä»»ä½•ç¡¬ä»¶ä¹‹ä¸Šï¼Œä»é—ç•™è®¾å¤‡åˆ°æ¶ˆè´¹çº§å®ä½“æœºã€è™šæ‹Ÿæœºï¼Œç”šè‡³å®¹å™¨ã€‚</li>
<li>å¯ç¼–ç¨‹ï¼šå¼€å‘è€…å¯ä»¥è½»æ¾åœ°å®Œæˆå¤šä¸ªå­˜å‚¨åŸºç¡€è®¾æ–½çš„è‡ªåŠ¨åŒ–åˆ›å»ºå’Œéƒ¨ç½²ï¼Œå¹¶ä¸”æ¯ä¸ªéƒ½èƒ½å€ŸåŠ©åŸºäºç­–ç•¥çš„èƒ½åŠ›è¿›è¡Œè‡ªå®šä¹‰ï¼Œé€‚é…ä¸Šå±‚åº”ç”¨çš„éœ€æ±‚ã€‚</li>
<li>å¯ä¼¸ç¼©ï¼šé€šè¿‡ä¾é ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„æ¶æ„ï¼ˆå³ç‚¹å¯¹ç‚¹ï¼‰ï¼ŒInfinitæ²¡æœ‰ä½¿ç”¨leader/followeræ¨¡å‹ï¼Œå› è€Œä¸ä¼šæœ‰ç“¶é¢ˆå’Œå•ç‚¹å¤±æ•ˆçš„é—®é¢˜ã€‚</li>
<li>è‡ªæ„ˆåˆï¼šInfinitçš„å†å¹³è¡¡ç­–ç•¥èƒ½è®©ç³»ç»Ÿé€‚åº”å„ç§æ•…éšœï¼ŒåŒ…æ‹¬æ‹œå åº­å°†å†›é—®é¢˜ã€‚</li>
<li>å¤šç”¨é€”ï¼šInfinitå¹³å°æä¾›äº†å—ã€å¯¹è±¡å’Œæ–‡ä»¶å­˜å‚¨çš„æ¥å£ï¼šNFSã€SMBã€AWS S3ã€OpenStack Swiftã€iSCSIå’ŒFUSEç­‰ç­‰ã€‚</li>
</ul>
<p><img src="/images/14811775178610.png" alt=""></p>
<p>åŸºæœ¬åŸç†ï¼š</p>
<p>â€¢ Federate all nodes in an overlay network for lookup and routing.<br>â€¢ Store data as blocks in a distributed hashtable (key-value store) with a per-block consensus.<br>â€¢ Use cryptographic access control to dispense from any leader.<br>â€¢ Use symmetrical operations to ensure resilience and flexibility.</p>
<p><img src="/images/14811780770073.jpg" alt=""></p>
<p><img src="/images/14811782445452.jpg" alt=""></p>
<p>Infinitä»¥volumeçš„å½¢å¼æŒ‚è½½åˆ°dockerå®¹å™¨ä¸­ï¼š</p>
<p><img src="/images/14811779192673.jpg" alt=""></p>
<h2 id="Docker-Alibabaâ€”â€”è¶…å¤§è§„æ¨¡DockeråŒ–çš„å®æˆ˜ç»éªŒ"><a href="#Docker-Alibabaâ€”â€”è¶…å¤§è§„æ¨¡DockeråŒ–çš„å®æˆ˜ç»éªŒ" class="headerlink" title="Docker@Alibabaâ€”â€”è¶…å¤§è§„æ¨¡DockeråŒ–çš„å®æˆ˜ç»éªŒ"></a><a href="https://yq.aliyun.com/articles/64256" target="_blank" rel="external">Docker@Alibabaâ€”â€”è¶…å¤§è§„æ¨¡DockeråŒ–çš„å®æˆ˜ç»éªŒ</a></h2><ul>
<li>AliDockerï¼Œå¹¶éé˜¿é‡Œäº‘ï¼Œä¸»è¦æ˜¯é˜¿é‡Œå†…éƒ¨ä¸šåŠ¡åœ¨ç”¨</li>
<li>Swarmæ”¹é€ æ”¯æŒå•swarmå®ä¾‹health nodes 2w+<ul>
<li>ä¼˜åŒ–è¿æ¥ç®¡ç†ã€æœ€å°åŒ–é”ç²’åº¦ã€ä¿®æ”¹diffç®—æ³•å‡å°‘nodeåˆ·æ–°æ—¶çš„å¼€é”€ã€å‡å°‘è¿æ¥çº¿ç¨‹</li>
</ul>
</li>
<li>Docker Engineå¢å¼º<ul>
<li>ç£ç›˜é…é¢ã€å›ºå®šIPã€Hooksã€è§£å†³hyperdé‡å¯å®¹å™¨é”€æ¯é—®é¢˜ç­‰</li>
</ul>
</li>
<li>é•œåƒåˆ†å‘ï¼šæµå¼åˆ†å‘ã€é•œåƒåˆ†æ‰¹é¢„çƒ­ã€P2Pç­‰</li>
<li>swarm-proxy HA</li>
</ul>
<p><img src="/images/14811788194621.jpg" alt="">7</p>
<h2 id="å¾®æœåŠ¡åœ¨å¾®ä¿¡åå°çš„æ¶æ„å®è·µ"><a href="#å¾®æœåŠ¡åœ¨å¾®ä¿¡åå°çš„æ¶æ„å®è·µ" class="headerlink" title="å¾®æœåŠ¡åœ¨å¾®ä¿¡åå°çš„æ¶æ„å®è·µ"></a><a href="http://ppt.geekbang.org/slide/show/607" target="_blank" rel="external">å¾®æœåŠ¡åœ¨å¾®ä¿¡åå°çš„æ¶æ„å®è·µ</a></h2><ul>
<li>å¤šåœ°è‡ªæ²»ï¼Œå›­åŒºäº’å¤‡ï¼šåŸå¸‚é—´RTT 30ms-400msï¼Œå›­åŒºé—´å°äº2ms</li>
<li>RPCï¼šprotobuf/libco</li>
<li>è°ƒåº¦ï¼šYardï¼ŒåŒå±‚è°ƒåº¦å™¨ï¼ˆMesos+Yardï¼‰</li>
<li>è¿‡è½½ä¿æŠ¤ï¼šè½»é‡åˆ†ç¦»ã€é˜Ÿåˆ—å¼ã€ç»„åˆå‘½ä»¤å¼</li>
</ul>
<p><img src="/images/14811817178100.jpg" alt=""></p>
<ul>
<li>æ•°æ®å­˜å‚¨ï¼šPaxosStoreï¼ŒåŒæ­¥å¤åˆ¶ã€å¤šä¸»å¤šå†™</li>
</ul>
<p><img src="/images/14811818656014.jpg" alt=""></p>
<h2 id="Go-å¾®æœåŠ¡æ¶æ„çš„åŸºçŸ³"><a href="#Go-å¾®æœåŠ¡æ¶æ„çš„åŸºçŸ³" class="headerlink" title="Go:å¾®æœåŠ¡æ¶æ„çš„åŸºçŸ³"></a><a href="http://ppt.geekbang.org/slide/show/615" target="_blank" rel="external">Go:å¾®æœåŠ¡æ¶æ„çš„åŸºçŸ³</a></h2><ul>
<li>è´Ÿè½½å‡è¡¡ï¼šseesawã€caddy</li>
<li>æœåŠ¡ç½‘å…³ï¼štykã€fabioã€vulcand</li>
<li>è¿›ç¨‹é—´é€šä¿¡ï¼šRESTfulã€RPCã€è‡ªå®šä¹‰<ul>
<li>RESTæ¡†æ¶ï¼šbeegoã€ginã€Irisã€microã€go-kitã€goa</li>
<li>RPCæ¡†æ¶ï¼šgrpcã€thriftã€hprose</li>
<li>è‡ªå®šä¹‰ï¼šåè®®ï¼Œç¼–è§£ç </li>
</ul>
</li>
<li>æœåŠ¡å‘ç°ï¼šetcdã€consulã€serf</li>
<li>è°ƒåº¦ç³»ç»Ÿï¼škubernetesã€swarmã€mesos</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—ï¼šNSQã€Nats</li>
<li>APMï¼ˆåº”ç”¨æ€§èƒ½ç›‘æ§ï¼‰ï¼šappdashã€Cloudinsightã€opentracing</li>
<li>é…ç½®ç®¡ç†ï¼šetcdã€consulã€mgmt</li>
<li>æ—¥å¿—åˆ†æï¼šBeatsã€Heka</li>
<li>æœåŠ¡ç›‘æ§ï¼šopen-falconã€prometheus</li>
<li>CI/CDï¼šDrone</li>
<li>ç†”æ–­å™¨ï¼šgatewayã€Hystrix-go</li>
</ul>
<h2 id="åŸºäºä¸‡èŠ‚ç‚¹Kubernetesæ”¯æ’‘å¤§è§„æ¨¡äº‘åº”ç”¨å®è·µ"><a href="#åŸºäºä¸‡èŠ‚ç‚¹Kubernetesæ”¯æ’‘å¤§è§„æ¨¡äº‘åº”ç”¨å®è·µ" class="headerlink" title="åŸºäºä¸‡èŠ‚ç‚¹Kubernetesæ”¯æ’‘å¤§è§„æ¨¡äº‘åº”ç”¨å®è·µ"></a><a href="http://ppt.geekbang.org/slide/show/586" target="_blank" rel="external">åŸºäºä¸‡èŠ‚ç‚¹Kubernetesæ”¯æ’‘å¤§è§„æ¨¡äº‘åº”ç”¨å®è·µ</a></h2><ul>
<li>åŸºäºOpenStackçš„IaaSï¼šè£å‰ªKVMé•œåƒã€ä¼˜åŒ–å¯åŠ¨æµç¨‹ï¼ŒOpenvswitch SDNã€Cephå­˜å‚¨</li>
<li>å®¹å™¨ä¸è™šæ‹Ÿæœºå…±ç”¨ä¸€å¥—è™šæ‹ŸåŒ–ç½‘ç»œ</li>
<li>Cephå­˜å‚¨ç›´æ¥æŒ‚è½½åˆ°å®¹å™¨</li>
<li>ç»Ÿä¸€çš„æ—¥å¿—æ”¶é›†ã€åˆ†æã€æœç´¢</li>
<li>Kubernetesè°ƒåº¦å™¨ä¼˜åŒ–ï¼šå°†åŸæ¥çš„ä¸²è¡Œé˜Ÿåˆ—æ”¹ä¸ºå¤šä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—</li>
<li>etcdé›†ç¾¤æ‰©å±•ï¼šå°†Pod/Node/ReplicationControlleræ‹†åˆ†åˆ°ä¸åŒçš„etcdé›†ç¾¤</li>
</ul>
<p><img src="/images/14811811876614.jpg" alt=""></p>
<p><img src="/images/14811813670269.jpg" alt=""></p>
<h1 id="20-å¤©æŒç»­å‹æµ‹ï¼Œå‘Šè¯‰ä½ äº‘å­˜å‚¨æ€§èƒ½å“ªå®¶å¼º-ğŸ“ˆ"><a href="#20-å¤©æŒç»­å‹æµ‹ï¼Œå‘Šè¯‰ä½ äº‘å­˜å‚¨æ€§èƒ½å“ªå®¶å¼º-ğŸ“ˆ" class="headerlink" title="20 å¤©æŒç»­å‹æµ‹ï¼Œå‘Šè¯‰ä½ äº‘å­˜å‚¨æ€§èƒ½å“ªå®¶å¼º ğŸ“ˆ"></a><a href="https://www.v2ex.com/t/326038?from=timeline&amp;isappinstalled=0#reply7" target="_blank" rel="external">20 å¤©æŒç»­å‹æµ‹ï¼Œå‘Šè¯‰ä½ äº‘å­˜å‚¨æ€§èƒ½å“ªå®¶å¼º</a> <a href="http://www.codingpy.com/specials/cbs_test/" target="_blank" rel="external">ğŸ“ˆ</a></h1><p>å¯¹é˜¿é‡Œäº‘å’Œè…¾è®¯äº‘ä¸¤ç§äº‘å­˜å‚¨äº§å“ï¼ˆäº‘ç›˜ï¼‰çš„æ€§èƒ½å’Œä»·æ ¼å¯¹æ¯”ï¼š</p>
<ul>
<li>æµ‹è¯•æ–¹æ³•ï¼šSNIAå‘å¸ƒçš„<a href="http://snia.org/sites/default/files/SSS_PTS_Enterprise_v1.1.pdf" target="_blank" rel="external">ä¼ä¸šçº§SSDè¯„æµ‹è§„èŒƒ</a>åŠ<a href="https://github.com/cloudharmony/block-storage" target="_blank" rel="external">å®ç°</a></li>
<li>é˜¿é‡Œäº‘ SSD äº‘ç›˜å¿…é¡»æ­é… I/O ä¼˜åŒ–å®ä¾‹æ‰èƒ½ç»™å‘æŒ¥æœ€å¤§æ€§èƒ½</li>
<li>è…¾è®¯äº‘é«˜æ•ˆäº‘ç›˜çš„è¯»å†™æ“ä½œå¯åŒæ—¶è¾¾åˆ°é¢„æœŸæ€§èƒ½å³°å€¼ï¼ˆæ•°æ®å— 16KB ä»¥ä¸‹ï¼‰ï¼Œè€Œé˜¿é‡Œäº‘æ–¹é¢ï¼Œè¯»å†™æ— æ³•åŒæ—¶è¾¾åˆ°é¢„æœŸæ€§èƒ½å³°å€¼</li>
<li>è…¾è®¯äº‘è¾¾åˆ°äº†é¢„æœŸçš„æ€§èƒ½ï¼›é˜¿é‡Œäº‘éƒ¨åˆ†æ²¡æœ‰è¾¾åˆ°ï¼Œ 400GB å®¹é‡çš„æ—¶å»¶è¿‡é«˜</li>
<li>è…¾è®¯äº‘é«˜æ•ˆäº‘ç›˜çš„æ—¶å»¶åœ¨ 1ms ä»¥ä¸‹ï¼Œ IOPS ã€ååé‡çš„ä¼˜åŠ¿æ›´åŠ çªå‡º</li>
<li>ä¸¤å®¶é«˜æ•ˆäº‘ç›˜çš„ IOPS è¡¨ç°å‡æ¯”è¾ƒç¨³å®šï¼Œå‡ ä¹å‘ˆä¸€æ¡ç›´çº¿ï¼Œåªæœ‰é˜¿é‡Œäº‘çš„ 400GB äº‘ç›˜æœ‰äº›ç•¥å¾®æ³¢åŠ¨</li>
<li>å®¹é‡è¶Šå¤§ï¼Œä¼¼ä¹é—²ç½®æ—¶é—´å¯¹æ€§èƒ½æ¢å¤çš„å½±å“è¶Šæ˜æ˜¾ï¼›é˜¿é‡Œäº‘ 400GB é«˜æ•ˆäº‘ç›˜çš„æ€§èƒ½æ³¢åŠ¨å—é—²ç½®æ—¶é—´å½±å“è¾ƒæ˜æ˜¾</li>
</ul>
<p><img src="/images/14811840736214.jpg" alt=""></p>
<h2 id="å¤–å–çš„èƒŒå-é¥¿äº†ä¹ˆåŸºç¡€æ¶æ„ä»0åˆ°1çš„æ¼”è¿›"><a href="#å¤–å–çš„èƒŒå-é¥¿äº†ä¹ˆåŸºç¡€æ¶æ„ä»0åˆ°1çš„æ¼”è¿›" class="headerlink" title="å¤–å–çš„èƒŒå-é¥¿äº†ä¹ˆåŸºç¡€æ¶æ„ä»0åˆ°1çš„æ¼”è¿›"></a><a href="http://ppt.geekbang.org/slide/show/619" target="_blank" rel="external">å¤–å–çš„èƒŒå-é¥¿äº†ä¹ˆåŸºç¡€æ¶æ„ä»0åˆ°1çš„æ¼”è¿›</a></h2><ul>
<li>è´Ÿè½½å‡è¡¡<ul>
<li>æœ€åˆï¼šHAProxyéƒ¨ç½²åœ¨å®¢æˆ·ç«¯æœ¬åœ°ï¼Œä¸éœ€è¦è€ƒè™‘HAProxyçš„é«˜å¯ç”¨ï¼›é—®é¢˜æ˜¯éƒ¨ç½²è§„æ¨¡å¤§ï¼Œç»´æŠ¤å®¢æˆ·åˆ—è¡¨å¤æ‚ï¼Œå¹¶ä¸”é…ç½®ä¸ç»Ÿä¸€</li>
<li>è§£å†³ï¼š<ul>
<li>RPC+å†…ç½®LB SDKï¼ŒæœåŠ¡è‡ªæ³¨å†Œ/è‡ªå‘ç°ï¼Œé…ç½®å°‘ï¼Œéƒ¨ç½²ç®€å•</li>
<li>Redis/DBè§£å†³æ–¹æ¡ˆGoProxy: DAL/Corvusä½œä¸ºæœåŠ¡è‡ªæ³¨å†Œï¼ŒGoProxyè®¢é˜…æ³¨å†Œäº‹ä»¶å¹¶è‡ªå¸¦æœåŠ¡å‘ç°çš„Haproxy</li>
<li>å¥åº·æ£€æŸ¥ï¼šå¿ƒè·³æ£€æµ‹ï¼Œè¿›ç¨‹åœ¨ã€ç«¯å£æ´»ä¸ä»£è¡¨æœåŠ¡å¯ç”¨</li>
</ul>
</li>
</ul>
</li>
<li>æ— æŸå‡çº§<ul>
<li>æœ€åˆï¼šå‘å¸ƒå‰é€šçŸ¥å®¢æˆ·ç«¯åœæ­¢è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å°†æ­£åœ¨å¤„ç†çš„è¯·æ±‚å¤„ç†å®Œæ¯•æ‰èƒ½å‡çº§</li>
<li>è§£å†³ï¼š<ul>
<li>RPCè°ƒç”¨ï¼šæœåŠ¡å‘ç°æœºåˆ¶ä¼šåœ¨æ³¨é”€æ—¶é€šçŸ¥å®¢æˆ·ç«¯ï¼Œç›´è¿æƒ…å†µä¸‹å®¢æˆ·ç«¯ä»å¯ç”¨åˆ—è¡¨ä¸­å‰”é™¤å‡†å¤‡ä¸‹çº¿çš„æœåŠ¡</li>
<li>æ•°æ®åº“è®¿é—®ï¼Œå®¢æˆ·ç«¯é™åˆ¶è¿æ¥å­˜æ´»æ—¶é—´ï¼ŒDALä¾§é‡è¿</li>
</ul>
</li>
</ul>
</li>
<li>åŸºç¡€æ¶æ„ï¼šå¼€æ”¾å¼æ¶æ„<ul>
<li>åŸºäºç»„ä»¶ï¼Œç»™ä¸šåŠ¡å¼€å‘å›¢é˜Ÿæœ€å¤§çš„è‡ªç”±</li>
<li>åŸºäºè¿è¡Œæ—¶ï¼Œç»™ä¸šåŠ¡å¼€å‘å›¢é˜Ÿæœ€å¤§é™åº¦çš„è‡ªç”±</li>
<li>å¼€æ”¾å°é—­åŸåˆ™ï¼šåŸºç¡€æ¡†æ¶åº”è¯¥æ˜¯å¯ä»¥æ‰©å±•çš„ï¼Œä½†æ˜¯ä¸å¯ä»¥â€œé€‰æ‹©â€çš„</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/04/Weekly-reading-list/" itemprop="url">
                  Weekly reading list
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-12-05T07:59:01+08:00" content="2016-12-05">
              2016-12-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Readings/" itemprop="url" rel="index">
                    <span itemprop="name">Readings</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="åˆ†å¸ƒå¼åå°æ¯«ç§’æœåŠ¡å¼•æ“"><a href="#åˆ†å¸ƒå¼åå°æ¯«ç§’æœåŠ¡å¼•æ“" class="headerlink" title="åˆ†å¸ƒå¼åå°æ¯«ç§’æœåŠ¡å¼•æ“"></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDE0Mjc4MA==&amp;mid=2650994968&amp;idx=1&amp;sn=6713bb3b59e1fb38c70f7178de136cfc&amp;scene=0#wechat_redirect" target="_blank" rel="external">åˆ†å¸ƒå¼åå°æ¯«ç§’æœåŠ¡å¼•æ“</a></h2><blockquote>
<p>è…¾è®¯QQå›¢é˜Ÿäº12æœˆ4æ—¥å¼€æºäº†ä¸€ä¸ªæœåŠ¡å¼€å‘è¿è¥æ¡†æ¶ï¼Œå«åšæ¯«ç§’æœåŠ¡å¼•æ“ï¼ˆMass Service Engine in Clusterï¼ŒMSECï¼‰ï¼Œå®ƒé›†RPCã€åå­—å‘ç°æœåŠ¡ã€è´Ÿè½½å‡è¡¡ã€ä¸šåŠ¡ç›‘æ§ã€ç°åº¦å‘å¸ƒã€å®¹é‡ç®¡ç†ã€æ—¥å¿—ç®¡ç†ã€Key-Valueå­˜å‚¨äºä¸€ä½“ï¼Œç›®çš„æ˜¯æé«˜å¼€å‘ä¸è¿è¥çš„æ•ˆç‡å’Œè´¨é‡ã€‚</p>
</blockquote>
<p><img src="/images/14809236732969.jpg" alt=""></p>
<p><img src="/images/14809236897310.jpg" alt=""></p>
<ul>
<li>æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡<ul>
<li>é›†ä¸­ç®¡ç†æ¯ä¸ªæœåŠ¡ï¼ˆåŒ…æ‹¬å¼‚æ„æœåŠ¡ï¼‰çš„IPåœ°å€</li>
<li>æœåŠ¡ä¹‹é—´RPCè°ƒç”¨ï¼šæœåŠ¡å+æ¥å£å</li>
<li>è·¯ç”±çš„åŒæ—¶ç»Ÿè®¡è¿‡å»ä¸€æ®µæ—¶é—´çš„æˆåŠŸç‡å’Œæ—¶å»¶</li>
</ul>
</li>
<li>æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆé€šè¿‡Protocol bufferç”Ÿæˆä¸åŒè¯­è¨€çš„æ¥å£ï¼‰ï¼Œå¦‚C/C++ã€Javaã€PHPç­‰</li>
<li>WebåŒ–çš„ç®¡ç†ç•Œé¢(Tomcat)</li>
<li>å­˜å‚¨ï¼šRedis cluster</li>
<li>å®˜æ–¹ç½‘ç«™ï¼š<a href="http://haomiao.qq.com" target="_blank" rel="external">http://haomiao.qq.com</a></li>
<li>Githubï¼š<a href="https://github.com/Tencent/MSEC" target="_blank" rel="external">https://github.com/Tencent/MSEC</a></li>
</ul>
<h2 id="Understanding-SELinux-Roles"><a href="#Understanding-SELinux-Roles" class="headerlink" title="Understanding SELinux Roles"></a><a href="http://danwalsh.livejournal.com/75683.html" target="_blank" rel="external">Understanding SELinux Roles</a></h2><p>SELinux labelåŒ…å«4ä¸ªéƒ¨åˆ†<code>user_u:role_r:type_t:level</code>ï¼Œæ¯ä¸ªç”¨æˆ·å¯ä»¥è®¿é—®çš„è§’è‰²ï¼š</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><div class="line"><span class="symbol">semanage</span> user -l</div><div class="line"></div><div class="line">         Labeling   <span class="keyword">MLS/ </span>      <span class="keyword">MLS/ </span>                       </div><div class="line"><span class="keyword">SELinux </span>User    Prefix     MCS Level  MCS Range       <span class="keyword">SELinux </span>Roles</div><div class="line"></div><div class="line"><span class="symbol">guest_u</span>             user       <span class="built_in">s0</span>         <span class="built_in">s0</span>                             guest_r</div><div class="line"><span class="symbol">root</span>                    user       <span class="built_in">s0</span>         <span class="built_in">s0</span>-<span class="built_in">s0</span>:<span class="built_in">c0</span>.c1023        staff_r sysadm_r system_r unconfined_r</div><div class="line"><span class="symbol">staff_u</span>               user       <span class="built_in">s0</span>         <span class="built_in">s0</span>-<span class="built_in">s0</span>:<span class="built_in">c0</span>.c1023        staff_r sysadm_r system_r unconfined_r</div><div class="line"><span class="symbol">sysadm_u</span>         user       <span class="built_in">s0</span>         <span class="built_in">s0</span>-<span class="built_in">s0</span>:<span class="built_in">c0</span>.c1023        sysadm_r</div><div class="line"><span class="symbol">system_u</span>          user       <span class="built_in">s0</span>         <span class="built_in">s0</span>-<span class="built_in">s0</span>:<span class="built_in">c0</span>.c1023        system_r unconfined_r</div><div class="line"><span class="symbol">unconfined_u</span>    user       <span class="built_in">s0</span>         <span class="built_in">s0</span>-<span class="built_in">s0</span>:<span class="built_in">c0</span>.c1023        system_r unconfined_r</div><div class="line"><span class="symbol">user_u</span>               user       <span class="built_in">s0</span>         <span class="built_in">s0</span>                             user_r</div><div class="line"><span class="symbol">xguest_u</span>           user       <span class="built_in">s0</span>         <span class="built_in">s0</span>                             xguest_r</div></pre></td></tr></table></figure>
<ul>
<li>system_r role is the default role for all processes started at boot</li>
<li>You can not assign an SELinux user a role that is not listed</li>
<li>object_r is not really a role, but more of a place holder.  Roles only make sense for processes, not for files</li>
<li>on the file system.  But the SELinux label requires a role for all labels.  object_r is the role that we use to fill the objects on disks role.  Changing a process to run as object_r or trying to assign a different role to a file will always be denied by the kernel.</li>
</ul>
<h2 id="Kompose-a-tool-to-go-from-Docker-compose-to-Kubernetes"><a href="#Kompose-a-tool-to-go-from-Docker-compose-to-Kubernetes" class="headerlink" title="Kompose: a tool to go from Docker-compose to Kubernetes"></a><a href="http://blog.kubernetes.io/2016/11/kompose-tool-go-from-docker-compose-to-kubernetes.html" target="_blank" rel="external">Kompose: a tool to go from Docker-compose to Kubernetes</a></h2><ul>
<li>æŠŠdocker-compose.ymlæˆ–dabè½¬æ¢ä¸ºkubernetes service+deployment</li>
<li>Github: <a href="https://github.com/kubernetes-incubator/kompose" target="_blank" rel="external">https://github.com/kubernetes-incubator/kompose</a></li>
</ul>
<figure class="highlight applescript"><table><tr><td class="code"><pre><div class="line">$ kompose <span class="comment">--bundle docker-compose-bundle.dab convert</span></div><div class="line">WARN[<span class="number">0000</span>]: Unsupported key networks - <span class="keyword">ignoring</span></div><div class="line"><span class="built_in">file</span> <span class="string">"redis-svc.json"</span> created</div><div class="line"><span class="built_in">file</span> <span class="string">"web-svc.json"</span> created</div><div class="line"><span class="built_in">file</span> <span class="string">"web-deployment.json"</span> created</div><div class="line"><span class="built_in">file</span> <span class="string">"redis-deployment.json"</span> created</div><div class="line"></div><div class="line">$ kompose -f docker-compose.yml convert</div><div class="line">WARN[<span class="number">0000</span>]: Unsupported key networks - <span class="keyword">ignoring</span></div><div class="line"><span class="built_in">file</span> <span class="string">"redis-svc.json"</span> created</div><div class="line"><span class="built_in">file</span> <span class="string">"web-svc.json"</span> created</div><div class="line"><span class="built_in">file</span> <span class="string">"web-deployment.json"</span> created</div><div class="line"><span class="built_in">file</span> <span class="string">"redis-deployment.json"</span> created</div></pre></td></tr></table></figure>
<h2 id="2016å¹´ç½‘ç»œè™šæ‹ŸåŒ–è¶‹åŠ¿"><a href="#2016å¹´ç½‘ç»œè™šæ‹ŸåŒ–è¶‹åŠ¿" class="headerlink" title="2016å¹´ç½‘ç»œè™šæ‹ŸåŒ–è¶‹åŠ¿"></a><a href="http://www.sdnlab.com/18153.html" target="_blank" rel="external">2016å¹´ç½‘ç»œè™šæ‹ŸåŒ–è¶‹åŠ¿</a></h2><ul>
<li>å¸‚åœºæŒç»­å‡æ¸©ï¼šNVçš„å¸‚åœºå·²ç»æ˜¯ä¸€ä¸ªæ•°åäº¿ç¾å…ƒçš„å¸‚åœºï¼ŒCiscoã€Juniperã€Nuageã€VMwareæ˜¯NVå¸‚åœºçš„å››å¤§å·¨å¤´ï¼Œä»–ä»¬å æ®äº†NVå¸‚åœºçš„ç»å¤§å¤šæ•°æ”¶å…¥</li>
<li>æ€ç§‘å’ŒVMwareå…¬å¸ƒçš„æ•°æ®æ˜¾ç¤ºå…¶ä¸NVç›¸å…³çš„æŠ•èµ„ç»„åˆåœ¨2016å¹´å°†è¿‘30äº¿ç¾å…ƒ</li>
<li>å®¹å™¨åŒ–ï¼šæ€ç§‘æ”¶è´­ContainerXï¼ŒVMWareæ¨å‡ºvSphereé›†æˆå®¹å™¨ï¼ˆVICï¼‰</li>
</ul>
<p><img src="/images/14809260496846.jpg" alt=""></p>
<h2 id="Amazonå‘å¸ƒä¸€å¤§æ³¢æ–°äº§å“"><a href="#Amazonå‘å¸ƒä¸€å¤§æ³¢æ–°äº§å“" class="headerlink" title="Amazonå‘å¸ƒä¸€å¤§æ³¢æ–°äº§å“"></a>Amazonå‘å¸ƒä¸€å¤§æ³¢æ–°äº§å“</h2><ul>
<li><a href="https://amazonlightsail.com/" target="_blank" rel="external">Amazon Lightsail</a>ï¼šå»‰ä»·VPSï¼Œä»·æ ¼è·ŸLightSale, DO, VULTR, Linodeç›¸åŒã€‚</li>
<li><a href="https://aws.amazon.com/cn/blogs/aws/developer-preview-ec2-instances-f1-with-programmable-hardware/" target="_blank" rel="external">F1 instance with FPGA</a>ï¼šVHDLå’ŒVerilogç»ˆäºæœ‰å‡ºè·¯äº†</li>
<li>ä»Šå¹´æ˜¯æœºå™¨å­¦ä¹ å¤§ç«çš„ä¸€å¹´ï¼ŒAmazonä¹Ÿéšå¤§æµï¼ˆå¾®è½¯ã€Googleï¼‰æ¨å‡ºäº†AIæœåŠ¡ï¼š<ul>
<li>Amazon Rekognitionå›¾åƒå¤„ç†å’Œåˆ†æ</li>
<li>Amazon Lexè‡ªç„¶è¯­è¨€å¤„ç†</li>
<li>Amazon Pollyæ–‡æœ¬åˆ°è¯­éŸ³çš„è½¬æ¢</li>
</ul>
</li>
<li><a href="https://aws.amazon.com/cn/snowmobile/" target="_blank" rel="external">AWS Snowmobile</a>ï¼šå¸¦å®½ä»æ¥éƒ½ä¸æ˜¯é—®é¢˜<br>  <img src="/images/14809265679834.jpg" alt=""></li>
</ul>
<h2 id="Linux-bcc-BPF-tcplife"><a href="#Linux-bcc-BPF-tcplife" class="headerlink" title="Linux bcc/BPF tcplife"></a><a href="http://www.brendangregg.com/blog/2016-11-30/linux-bcc-tcplife.html" target="_blank" rel="external">Linux bcc/BPF tcplife</a></h2><figure class="highlight tap"><table><tr><td class="code"><pre><div class="line"><span class="comment"># ./tcplife -D 80</span></div><div class="line">PID   COMM       LADDR           LPORT RADDR           RPORT TX_KB RX_KB MS</div><div class="line">27448 curl       100.66.11.247  <span class="number"> 54146 </span>54.154.224.174 <span class="number"> 80 </span>      <span class="number"> 0 </span>   <span class="number"> 1 </span>263.85</div><div class="line">27450 curl       100.66.11.247  <span class="number"> 20618 </span>54.154.164.22  <span class="number"> 80 </span>      <span class="number"> 0 </span>   <span class="number"> 1 </span>243.62</div><div class="line">27452 curl       100.66.11.247  <span class="number"> 11480 </span>54.154.43.103  <span class="number"> 80 </span>      <span class="number"> 0 </span>   <span class="number"> 1 </span>231.16</div><div class="line">27454 curl       100.66.11.247  <span class="number"> 31382 </span>54.154.15.7    <span class="number"> 80 </span>      <span class="number"> 0 </span>   <span class="number"> 1 </span>249.95</div><div class="line">27456 curl       100.66.11.247  <span class="number"> 33416 </span>52.210.59.223  <span class="number"> 80 </span>      <span class="number"> 0 </span>   <span class="number"> 1 </span>545.72</div><div class="line">27458 curl       100.66.11.247  <span class="number"> 16406 </span>52.30.140.35   <span class="number"> 80 </span>      <span class="number"> 0 </span>   <span class="number"> 1 </span>222.29</div><div class="line">27460 curl       100.66.11.247  <span class="number"> 11634 </span>52.30.133.135  <span class="number"> 80 </span>      <span class="number"> 0 </span>   <span class="number"> 1 </span>217.52</div><div class="line">27462 curl       100.66.11.247  <span class="number"> 25660 </span>52.30.126.182  <span class="number"> 80 </span>      <span class="number"> 0 </span>   <span class="number"> 1 </span>250.81</div><div class="line">[...]</div><div class="line"></div><div class="line"><span class="comment"># ./tcplife -h</span></div><div class="line">usage: tcplife [-h] [-T] [-t] [-w] [-s] [-p PID] [-L LOCALPORT]</div><div class="line">               [-D REMOTEPORT]</div><div class="line"></div><div class="line">Trace the lifespan of TCP sessions and summarize</div><div class="line"></div><div class="line">optional arguments:</div><div class="line">  -h, --help            show this help message and exit</div><div class="line">  -T, --time            include time column on output (HH:MM:SS)</div><div class="line">  -t, --timestamp       include timestamp on output (seconds)</div><div class="line">  -w, --wide            wide column output (fits IPv6 addresses)</div><div class="line">  -s, --csv             comma seperated values output</div><div class="line">  -p PID, --pid PID     trace this PID only</div><div class="line">  -L LOCALPORT, --localport LOCALPORT</div><div class="line">                        comma-separated list of local ports to trace.</div><div class="line">  -D REMOTEPORT, --remoteport REMOTEPORT</div><div class="line">                        comma-separated list of remote ports to trace.</div><div class="line"></div><div class="line">examples:</div><div class="line">    ./tcplife           <span class="comment"># trace all TCP connect()s</span></div><div class="line">    ./tcplife -t        <span class="comment"># include time column (HH:MM:SS)</span></div><div class="line">    ./tcplife -w        <span class="comment"># wider colums (fit IPv6)</span></div><div class="line">    ./tcplife -stT      <span class="comment"># csv output, with times &amp; timestamps</span></div><div class="line">    ./tcplife -p<span class="number"> 181 </span>   <span class="comment"># only trace PID 181</span></div><div class="line">    ./tcplife -L<span class="number"> 80 </span>    <span class="comment"># only trace local port 80</span></div><div class="line">    ./tcplife -L 80,81  <span class="comment"># only trace local ports 80 and 81</span></div><div class="line">    ./tcplife -D<span class="number"> 80 </span>    <span class="comment"># only trace remote port 80</span></div></pre></td></tr></table></figure>
<h2 id="cgroup-namespace"><a href="#cgroup-namespace" class="headerlink" title="cgroup namespace"></a><a href="http://hustcat.github.io/cgroup-namespace/" target="_blank" rel="external">cgroup namespace</a></h2><p>ä¹‹å‰ï¼Œåœ¨ä¸€ä¸ªå®¹å™¨æŸ¥çœ‹/proc/$PID/cgroupï¼Œæˆ–è€…åœ¨å®¹å™¨æŒ‚è½½cgroupæ—¶ï¼Œä¼šçœ‹åˆ°æ•´ä¸ªç³»ç»Ÿçš„cgroupä¿¡æ¯ï¼›åœ¨å†…æ ¸ä»4.6å¼€å§‹ï¼Œæ”¯æŒcgroup namespace ï¼ˆ<a href="https://lwn.net/Articles/618873/" target="_blank" rel="external">https://lwn.net/Articles/618873/</a>ï¼‰ã€‚</p>
<blockquote>
<p>(1)å¯ä»¥é™åˆ¶å®¹å™¨çš„cgroup filesytemè§†å›¾ï¼Œä½¿å¾—åœ¨å®¹å™¨ä¸­ä¹Ÿå¯ä»¥å®‰å…¨çš„ä½¿ç”¨cgroupï¼›<br>(2)æ­¤å¤–ï¼Œä¼šä½¿å®¹å™¨è¿ç§»æ›´åŠ å®¹æ˜“ï¼›åœ¨è¿ç§»æ—¶ï¼Œ/proc/self/cgroupéœ€è¦å¤åˆ¶åˆ°ç›®æ ‡æœºå™¨ï¼Œè¿™è¦æ±‚å®¹å™¨çš„cgroupè·¯å¾„æ˜¯å”¯ä¸€çš„ï¼Œå¦åˆ™å¯èƒ½ä¼šä¸ç›®æ ‡æœºå™¨å†²çªã€‚æœ‰äº†cgroupnsï¼Œæ¯ä¸ªå®¹å™¨éƒ½æœ‰è‡ªå·±çš„cgroup filesystemè§†å›¾ï¼Œä¸ç”¨æ‹…å¿ƒè¿™ç§å†²çªã€‚</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/14/KubeCon-2016è§é—»/" itemprop="url">
                  KubeCon/CloudNativeCon 2016è§é—»
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-11-14T09:49:52+08:00" content="2016-11-14">
              2016-11-14
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>é¢˜è®°ï¼šä¸Šå‘¨å»è¥¿é›…å›¾å‚åŠ äº†<a href="http://events.linuxfoundation.org/events/kubecon" target="_blank" rel="external">KubeCon&amp;CloudNativeCon 2016</a>ï¼Œä¸ä»…è§åˆ°Dawnã€Brendanã€Timä»¥åŠSig Nodeçš„å„è·¯å¤§ç¥ï¼Œè¿˜å‚åŠ äº†ä¸å°‘æœ‰è¶£çš„sessionã€‚</p>
<h2 id="Compiling-to-Containers-Brendan-Burns-Microsoft"><a href="#Compiling-to-Containers-Brendan-Burns-Microsoft" class="headerlink" title="Compiling to Containers - Brendan Burns, Microsoft"></a><a href="https://cnkc16.sched.org/event/8K8y/compiling-to-containers-brendan-burns-microsoft?iframe=no&amp;w=100%&amp;sidebar=yes&amp;bg=no" target="_blank" rel="external">Compiling to Containers</a> - Brendan Burns, Microsoft</h2><p>Containerså¯ä»¥çœ‹ä½œæ˜¯ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿçš„â€œæ±‡ç¼–è¯­è¨€â€ï¼Œè¿™æ ·åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç®¡ç†å®é™…ä¸Šå°±æˆäº†å¼€å‘â€œContaineræ±‡ç¼–è¯­è¨€â€ã€‚Brendanè¿˜ä»¥JavaScriptä¸ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•åŸºäº<a href="https://github.com/brendandburns/metaparticle" target="_blank" rel="external">Metaparticle</a>æ¥æ”¯æŒä¸åŒçš„service pattern:</p>
<ul>
<li>Simple Service: simply exposes a function as an HTTP service.</li>
<li>Scatter/Gather: fans all requests out to all leaf nodes (scatter phase), all responses are then aggregated in a root node (gather phase), this aggregate response is returned to the caller.</li>
<li>Shard: select a shard (replica) for a request.</li>
<li>Spread: similar to Shard, but uses a randomized shardingFunction.</li>
</ul>
<h2 id="Unik-Unikernel-Runtime-for-Kubernetes-Idit-Levine-EMC"><a href="#Unik-Unikernel-Runtime-for-Kubernetes-Idit-Levine-EMC" class="headerlink" title="Unik: Unikernel Runtime for Kubernetes - Idit Levine, EMC"></a><a href="https://cnkc16.sched.org/event/8K8v/unik-unikernel-runtime-for-kubernetes-idit-levine-emc?iframe=no&amp;w=100%&amp;sidebar=yes&amp;bg=no" target="_blank" rel="external">Unik: Unikernel Runtime for Kubernetes</a> - Idit Levine, EMC</h2><p><a href="https://github.com/emc-advanced-dev/unik" target="_blank" rel="external">Unik</a>æ˜¯ä¸€ä¸ªå°†åº”ç”¨ç¼–è¯‘æˆunikernelçš„å·¥å…·ï¼Œæ”¯æŒrump/OSv/IncludeOS/MirageOSç­‰ï¼Œç¼–è¯‘çš„ç»“æœå¯ä»¥ç›´æ¥è·‘åœ¨å…¬æœ‰äº‘æˆ–è€…æœ¬åœ°çš„è™šæ‹Ÿæœºä¸­ã€‚</p>
<p>Unikåœ¨Kubernetesä¸­å®ç°äº†ä¸€ä¸ªç‰¹æ®Šçš„<a href="https://github.com/emc-advanced-dev/kubernetes/tree/master/pkg/kubelet/unik" target="_blank" rel="external">runtime</a>ï¼Œå¹¶å¯ä»¥é€šè¿‡kubernetesæ¥ç®¡ç†unikï¼š</p>
<ul>
<li>é•œåƒç®¡ç†ï¼šå®é™…ä¸Šé€šè¿‡rktæ¥æ“ä½œé•œåƒ</li>
<li>Podç®¡ç†ï¼šone Pod == one VM == one Containerï¼Œé€šè¿‡è°ƒç”¨unik daemonæ¥æ“ä½œ</li>
</ul>
<h2 id="Technical-View-Comparison-of-Container-Orchestration-and-Management-Systems-Lei-Zhang-HyperHQ"><a href="#Technical-View-Comparison-of-Container-Orchestration-and-Management-Systems-Lei-Zhang-HyperHQ" class="headerlink" title="Technical View: Comparison of Container Orchestration and Management Systems - Lei Zhang, HyperHQ"></a><a href="https://cnkc16.sched.org/event/8K3x/technical-view-comparison-of-container-orchestration-and-management-systems-lei-zhang-hyperhq?iframe=no&amp;w=100%&amp;sidebar=yes&amp;bg=no" target="_blank" rel="external">Technical View: Comparison of Container Orchestration and Management Systems</a> - Lei Zhang, HyperHQ</h2><p>æˆ‘å¸å¼ ç£ŠåŒå­¦çš„å¤§ä½œï¼Œä»æ¶æ„ã€æ§åˆ¶å¹³é¢ã€æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡ã€è°ƒåº¦ç­‰å„ä¸ªè§’åº¦å¯¹æ¯”Kubernetes/Swarmkit/Mesosç­‰å¸¸è§å®¹å™¨ç¼–æ’ç³»ç»Ÿï¼Œå¹¶ä»¥<a href="https://github.com/hyperhq/hypernetes" target="_blank" rel="external">hypernetes</a>å’Œ<a href="http://hyper.sh/" target="_blank" rel="external">Hyper Container Service</a>ä¸ºä¾‹è¯´æ˜ä¸ºä»€ä¹ˆkubernetesæ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚</p>
<p><img src="/images/1-4.png" alt="1"><br><img src="/images/2-3.png" alt="2"></p>
<h2 id="Everything-You-Ever-Wanted-to-Know-About-Resource-Scheduling-But-Were-Afraid-to-Ask-Tim-Hockin-Google"><a href="#Everything-You-Ever-Wanted-to-Know-About-Resource-Scheduling-But-Were-Afraid-to-Ask-Tim-Hockin-Google" class="headerlink" title="Everything You Ever Wanted to Know About Resource Scheduling, But Were Afraid to Ask - Tim Hockin, Google"></a><a href="https://cnkc16.sched.org/event/8K8l/everything-you-ever-wanted-to-know-about-resource-scheduling-but-were-afraid-to-ask-tim-hockin-google?iframe=no&amp;w=100%&amp;sidebar=yes&amp;bg=no" target="_blank" rel="external">Everything You Ever Wanted to Know About Resource Scheduling, But Were Afraid to Ask</a> - Tim Hockin, Google</h2><p>Kubernetes is fundamentally about resource management:</p>
<ul>
<li>CPU/Memory/Disk</li>
<li>Network/Ports/IP addresses</li>
<li>PIDs</li>
<li>GPUs</li>
<li>Storage</li>
<li>Power</li>
</ul>
<p>å…³äºèµ„æºç®¡ç†çš„ä¸‰æ–¹é¢:</p>
<ul>
<li>Isolationï¼šä¿è¯åº”ç”¨å¯ä»¥è·å–æƒ³è¦çš„èµ„æºå¹¶ä¸”ä¸å½±å“å…¶ä»–åº”ç”¨ï¼Œç›®å‰åŸºäºRequests/Limitsåªæ”¯æŒcpuå’Œå†…å­˜</li>
<li>Sizingï¼šåº”è¯¥ç»™ç”¨æˆ·åˆ†é…å¤šå°‘èµ„æºå‘¢ï¼Œæ²¡æœ‰ç»Ÿä¸€çš„æ–¹æ³•ï¼Œåªèƒ½é benchmarkï¼Œä½†ç²¾ç¡®çš„benchmarkå¾ˆéš¾ï¼Œæ‰€ä»¥Kubernetesæä¾›äº†Horizontal Pod Autoscalerï¼Œæœªæ¥å¯èƒ½è¿˜ä¼šæœ‰VerticalPodAutoscaler</li>
<li>Utilizationï¼šèµ„æºçš„å®é™…ä½¿ç”¨æƒ…å†µæ˜¯å•¥æ ·çš„ï¼Œæ¶‰åŠPriorityè°ƒåº¦ã€Quotaç®¡ç†ã€Overcommitç­‰ç­‰ã€‚</li>
</ul>
<p><img src="/images/3-4.png" alt="3"></p>
<p>Slideè§<a href="https://speakerdeck.com/thockin/everything-you-ever-wanted-to-know-about-resource-scheduling-dot-dot-dot-almost" target="_blank" rel="external">è¿™é‡Œ</a>.</p>
<h2 id="Self-hosted-Scale-and-Federation-with-Kubernetes-v1-4-and-Beyond-Brandon-Philips-CoreOS"><a href="#Self-hosted-Scale-and-Federation-with-Kubernetes-v1-4-and-Beyond-Brandon-Philips-CoreOS" class="headerlink" title="Self-hosted, Scale, and Federation with Kubernetes v1.4 and Beyond - Brandon Philips, CoreOS"></a><a href="https://cnkc16.sched.org/event/8K3v/self-hosted-scale-and-federation-with-kubernetes-v14-and-beyond-brandon-philips-coreos-inc?iframe=yes&amp;w=100%&amp;sidebar=yes&amp;bg=no#" target="_blank" rel="external">Self-hosted, Scale, and Federation with Kubernetes v1.4 and Beyond</a> - Brandon Philips, CoreOS</h2><p>åŸºæœ¬çš„ideaæ˜¯ç”¨Kubernetesæ¥ç®¡ç†Kubernetesçš„éƒ¨ç½²å’Œå‡çº§ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå­µåŒ–çŠ¶æ€çš„é¡¹ç›®<a href="https://github.com/kubernetes-incubator/bootkube" target="_blank" rel="external">bootkube</a>ã€‚ç”±äºkubeletåˆå§‹åŒ–éœ€è¦æ§åˆ¶å¹³é¢çš„é…åˆï¼Œbootkubeä¼šåœ¨ä¸€å¼€å§‹çš„æ—¶å€™ä¼šå¯åŠ¨ä¸€ä¸ªæš‚æ—¶çš„æ§åˆ¶å¹³é¢ï¼ˆapi-server, scheduler, controller managerï¼‰ï¼Œéƒ¨ç½²å®Œæˆåå†æ›¿æ¢å›æ¥ã€‚</p>
<p>éƒ¨ç½²å‰å°†bootkubeä½œä¸ºæ§åˆ¶å¹³é¢ï¼š</p>
<p><img src="/images/bootkube-1.png" alt="bootkube-1"></p>
<p>éƒ¨ç½²åæ›¿æ¢æˆçœŸæ­£çš„æ§åˆ¶å¹³é¢ï¼š</p>
<p><img src="/images/bootkube-2.png" alt="bootkube-2"></p>
<p>ç›¸å…³æ–‡æ¡£</p>
<ul>
<li><a href="https://github.com/kubernetes-incubator/bootkube" target="_blank" rel="external">Incubator BootKube</a></li>
<li><a href="https://speakerdeck.com/philips/kubecon-2016-self-hosted-scale-and-federation-with-kubernetes-v1-dot-4-and-beyond" target="_blank" rel="external">Slide</a></li>
<li><a href="https://docs.google.com/document/d/1VNp4CMjPPHevh2_JQGMl-hpz9JSLq3s7HlI87CTjl-8/edit" target="_blank" rel="external">Design of bootkube</a></li>
<li><a href="https://coreos.com/blog/self-hosted-kubernetes.html" target="_blank" rel="external">Blog of self-booted kubernetes</a></li>
<li><a href="https://docs.google.com/document/d/1_I6xT0XHCoOqZUT-dtpxzwvYpTR5JmFQY0S4gL2PPkU/edit#heading=h.yeahbhtih70g" target="_blank" rel="external">Kubelet as a Container and Self-Hosted Kubernetes</a></li>
</ul>
<h2 id="F2F"><a href="#F2F" class="headerlink" title="F2F"></a>F2F</h2><p><strong><a href="https://docs.google.com/document/d/1ZVQIzLuHsBFDCw-QLO30rqRlSNSc1xynfs9GAFrjeVc/edit" target="_blank" rel="external">Sig-node F2F</a></strong></p>
<ul>
<li>Performance-Sensitive Application Platform<ul>
<li>é«˜æ€§èƒ½åº”ç”¨çš„åœºæ™¯ï¼Œæ¯”å¦‚telecom, HFTç­‰ï¼Œéœ€è¦NUMAã€GPUã€sysctlsã€hugepageã€cpusetç­‰ç­‰çš„æ”¯æŒã€‚</li>
<li>ä¸€ä¸ªideaæ˜¯é€šè¿‡daemonsetå¹¶é…åˆNodeAllocatable</li>
</ul>
</li>
<li>CRI blockers and progress<ul>
<li>1.5çš„featureåŸºæœ¬å®Œæˆï¼Œåªå‰©ä¸‹ä¸€äº›bug fixes</li>
<li>per-pod cgroups</li>
<li>monitoring</li>
<li>api versioning</li>
<li>hostport network</li>
<li>metrics</li>
<li>CRI validation tests</li>
<li>auth</li>
</ul>
</li>
<li>Runtime agnostic debugging tools<ul>
<li>CLI for CRI?</li>
</ul>
</li>
<li>NodeSpec standardization</li>
<li>Packaging</li>
</ul>
<p><strong><a href="https://docs.google.com/document/d/1wtJeXhiVOL7qdDK_zouZPjskTIrsOLmD-9Ij478y7_Y/edit" target="_blank" rel="external">OCI F2F</a></strong></p>
<p>æœ€ä¸»è¦çš„æ˜¯<code>Runtime CLI Spec</code>å’Œ<code>Image Spec rc3</code>ã€‚æ¯”è¾ƒæœ‰è¶£çš„æ˜¯<a href="https://github.com/vbatts/nspawn-oci" target="_blank" rel="external">systemd wrapper / rkt wrapper for OCI runtime-spec CLI</a>ï¼Œrktä¹Ÿè¦åŠ å…¥OCIçš„å¤§è¥ã€‚</p>
<h2 id="Developer-Summit"><a href="#Developer-Summit" class="headerlink" title="Developer Summit"></a>Developer Summit</h2><p><strong><a href="https://docs.google.com/presentation/d/1SD6a6eJl47t0qyTFE8GzaiytW4T_crdWgYAMCaLy1W8" target="_blank" rel="external">Scaling the Kubernetes CodeBase</a></strong></p>
<p>Kubernetesä½¿ç”¨githubæ¥ç®¡ç†ä»£ç åº“ï¼Œä½†ç°åœ¨ç¢°åˆ°äº†æ˜æ˜¾çš„ç“¶é¢ˆï¼šä»2015å¹´ä¸‹åŠå¹´å¼€å§‹<a href="http://velodrome.k8s.io/dashboard/db/kubernetes-developer-velocity" target="_blank" rel="external">mergeæ—¶é—´æ˜æ˜¾åŠ é•¿</a>ï¼Œopen issueså’ŒPRsä¸€ç›´å†å¢é•¿ï¼Œå¤§é‡æ— å…³ç´§è¦çš„githubé€šçŸ¥ç­‰ç­‰ã€‚æœªæ¥è®¡åˆ’å°†Kubernetesçš„ä»£ç æ‹†åˆ†åˆ°å¤šä¸ªrepoä¸­ï¼Œkuberentesä»£ç åº“åªä¿ç•™æ ¸å¿ƒä»£ç ï¼Œå¹¶é€šè¿‡Extension mechanismæ¥æ”¯æŒå„ç§åŠŸèƒ½ï¼š</p>
<ul>
<li>Apiserver federation</li>
<li>Authorization hooks</li>
<li>Admission-control hooks</li>
<li>Initializers and finalizers</li>
<li>ThirdPartyResource</li>
<li>Kubectl extensions</li>
<li>Service Broker, Operators</li>
<li>Controller pattern</li>
<li>External cloudproviders</li>
<li>CRI, network, and storage plugins</li>
<li>Cluster addons: UI, monitoring, logging</li>
<li>Feature gates, feature discovery, dependency management</li>
</ul>
<p>æ›´å¤šè®°å½•è§<a href="https://docs.google.com/document/d/1zN2DWKerXwbzxZTO52wBRqp_uHMdLp8P52xYOmp5WZ4/edit" target="_blank" rel="external">è¿™é‡Œ</a>.</p>
<p><strong>å…¶ä»–çš„Summitç®€ä»‹</strong></p>
<ul>
<li><a href="https://docs.google.com/presentation/d/1dFfN3_9VM4cRKknZB9_0wsM_1YLJToRTEx7dX6BoEhI" target="_blank" rel="external">Kubernetes 2017 Features &amp; Roadmaps</a> <a href="https://docs.google.com/spreadsheets/d/154cAee2mOn3LoQDgpgG2ZzAIdIlQ_KnMlghGjnGwQ1w" target="_blank" rel="external">Roadmap</a><ul>
<li>Scale the project (tablestakes)</li>
<li>Reference architectures for application workflows</li>
<li>Secure multi-tenancy with service catalog</li>
<li>Production ready cluster lifecycle</li>
<li>Multi-cloud support for AWS / Azure / on premises</li>
</ul>
</li>
<li><a href="https://docs.google.com/document/d/11kK39Zz3zxIY9-GFa8buqqWYOrctFQ7hvOw5NBFwJL0/edit#heading=h.n0vlwrfu65r1" target="_blank" rel="external">Cluster Lifecycle Deployment &amp; Upgrade Roadmap</a><ul>
<li>HA</li>
<li>Upgrades</li>
<li>Config Management</li>
<li>Toolbox vs. guided flow</li>
<li>Documentation</li>
<li>Conformance Testing</li>
<li>PKI</li>
</ul>
</li>
<li><a href="https://docs.google.com/presentation/d/1GFuKgN-1kMmcg41T9HsasP8YEWtMAipEibYnwGkQuHo" target="_blank" rel="external">Documentation</a> and <a href="https://docs.google.com/document/d/1VYoVl63Iq2QSKxpoV7HGXmWasxU5EQCAuoIItj-ODvM/edit" target="_blank" rel="external">here</a></li>
<li><a href="https://docs.google.com/document/d/1cJhpjRcXpTmTWQswEfBqSbrfqrawtD9ZlWW30Q3BWv4/edit" target="_blank" rel="external">K8s Dev Summit: Outstanding Issues and PRs</a><ul>
<li>Issues 4600+, PRs 600+ï¼Œè¿˜åœ¨ä¸æ–­å¢é•¿ä¸­</li>
<li><a href="https://github.com/kubernetes/community/tree/master/sig-contribx" target="_blank" rel="external">Sig Contribx</a>ä¼šè·Ÿè¿›å¤„ç†è¿™ä¸ªé—®é¢˜</li>
</ul>
</li>
<li><a href="https://docs.google.com/document/d/1WmRwT3nhLXTYRLKlj9rjZmEXv3BEu7TFX29nuaO3enA/edit#heading=h.w90umf5dyer3" target="_blank" rel="external">Multi-tenancy</a></li>
<li><a href="https://docs.google.com/document/d/1X5i-Z3GsFyknxq4LyB3cObXEm5ds7DTUYOKwHAMHK5A/edit" target="_blank" rel="external">Azure &amp; AWS Kubernetes Discussion</a></li>
<li><a href="https://docs.google.com/document/d/1klHgGFKtSPHGNlG24LDb5-ornBUtZLcUnEjF8XKXDes/edit" target="_blank" rel="external">Contrib notes</a> and <a href="https://docs.google.com/document/d/19B2vcK6Y3xE3JO7sd4n6lPF0m9bBVZpNucvcR3MwEXA/edit" target="_blank" rel="external">On developer onboarding</a></li>
<li><a href="https://docs.google.com/document/d/1p7scsTPzPyouktBFTxu4RhRwW8yUn5Lj7VGY9SaOo-8/edit" target="_blank" rel="external">Compute resource management</a></li>
<li><a href="https://docs.google.com/document/d/1K2hh7nQ9glYzGE-5J7oKBB7oK3S_MKqwCISXZK-sB2Q/edit" target="_blank" rel="external">Logging volumes</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/24/Kubernetes-container-runtime-interface/" itemprop="url">
                  Kubernetes container runtime interface
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-25T06:59:31+08:00" content="2016-09-25">
              2016-09-25
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>é¢˜è®°ï¼šæœ€è¿‘ä¸€æ®µæ—¶é—´åœ¨åšKuberneteså®¹å™¨å¼•æ“æ¥å£ï¼ˆContainer Runtime Interfaceï¼Œ CRIï¼‰çš„é‡æ„ï¼Œå¹¶æ”¯æŒä»¥æ’ä»¶çš„æ–¹å¼å¼•å…¥å¤–éƒ¨å®¹å™¨å¼•æ“ã€‚CRIè¿˜åœ¨ç´§å¼ æœ‰åºçš„å¼€å‘ä¸­ï¼Œé¢„è®¡åœ¨v1.5å‘å¸ƒç¬¬ä¸€ä¸ªalphaç‰ˆã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯CRI"><a href="#ä»€ä¹ˆæ˜¯CRI" class="headerlink" title="ä»€ä¹ˆæ˜¯CRI"></a>ä»€ä¹ˆæ˜¯CRI</h2><p>CRIæ˜¯Kubeletï¼ˆè´Ÿè´£ç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸçš„æœåŠ¡ï¼‰ä¸å®¹å™¨å¼•æ“ä¹‹é—´çš„æ¥å£ã€‚ä¸ºäº†é€‚åº”å¤šç§ä¸åŒçš„å®¹å™¨å¼•æ“ï¼ŒKubeletåœ¨åŠ å…¥rktçš„æ—¶å€™å°±å·²ç»åœ¨docker APIçš„åŸºç¡€ä¸ŠæŠ½è±¡äº†ä¸€ä¸ªRuntimeæ¥å£ï¼Œåªæ˜¯ç”±äºä¸€äº›ç‰¹å®šçš„ç¼ºé™·ï¼Œåœ¨è¿™ä¸ªæ¥å£ä¸Šä¸å¤ªå®¹æ˜“å¼•å…¥å…¶ä»–æ–°çš„å®¹å™¨å¼•æ“ï¼š</p>
<ul>
<li>Runtimeæ¥å£çš„æŠ½è±¡åº¦å¤ªé«˜ï¼Œå¯¼è‡´ä¸€äº›åŸæœ¬è¯¥åœ¨Kubeletæ§åˆ¶çš„é€»è¾‘è¢«æ”¾åˆ°äº†Runtimeå®ç°é‡Œé¢ã€‚æ¯”å¦‚åœ¨å½“å‰çš„å®ç°ä¸­ï¼Œrktå’Œdockerçš„<code>SyncPod</code>ï¼ˆè´Ÿè´£Podåˆ›å»ºçš„æ¥å£ï¼‰å­˜åœ¨å¤§é‡é‡å¤çš„é€»è¾‘ï¼Œæ¯æ¬¡ä¿®æ”¹dockeréƒ¨åˆ†çš„æ—¶ï¼Œéƒ½æœ‰å¯èƒ½éœ€è¦åŒæ—¶ä¿®æ”¹rktéƒ¨åˆ†ã€‚è¿™æ ·ï¼Œå¦‚æœå†åŠ å…¥æ–°çš„å®¹å™¨å¼•æ“çš„è¯ï¼ŒåŒæ—¶ä¿®æ”¹å¤šä¸ªRuntimeéƒ¨åˆ†çš„ä»£ç æ˜¯æ²¡æ³•ç»´æŠ¤çš„ã€‚</li>
<li>Runtimeæ¥å£æ˜¯é›†æˆåœ¨Kubeletå†…éƒ¨çš„ï¼Œé›†æˆå®¹å™¨å¼•æ“ç›¸å…³çš„ä»£ç éœ€è¦æ”¾åˆ°Kubernetesä»£ç åº“é‡Œé¢ï¼Œè¿™åŒæ ·å¸¦æ¥äº†ç»´æŠ¤çš„é—®é¢˜ï¼šä»£ç ç»´æŠ¤éº»çƒ¦ï¼Œä»»ä½•ä¸€ä¸ªå®¹å™¨å¼•æ“ä¿®æ”¹äº†ä»£ç éƒ½éœ€è¦å‘å¸ƒæ–°çš„kubeletï¼›é›†æˆæµ‹è¯•éº»çƒ¦ï¼Œè¦ä¸ºæ¯ä¸ªä¸åŒçš„å®¹å™¨å¼•æ“éƒ¨ç½²ä¸åŒçš„é›†æˆæµ‹è¯•ç¯å¢ƒã€‚</li>
<li>æ²¡æœ‰æä¾›å®¹å™¨åˆ›å»ºçš„æ¥å£ï¼Œæ— æ³•ç›´æ¥åœ¨Kubeleté‡Œé¢åšåˆ°å¯¹å®¹å™¨çš„ç²¾ç»†æ§åˆ¶ã€‚</li>
<li>è€¦åˆäº†é•œåƒå’Œå®¹å™¨ç®¡ç†ï¼Œè€Œå®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸæœ¬æ¥å°±æ˜¯ç‹¬ç«‹çš„ã€‚</li>
</ul>
<p>æ—¢ç„¶Runtimeæ¥å£æœ‰å¾ˆå¤šé—®é¢˜ï¼Œå¹¶ä¸”æœ‰å¾ˆå¤šå®¹å™¨å¼•æ“æƒ³è¦é›†æˆåˆ°Kubernetesä¸­ï¼Œæ‰€ä»¥æœ‰å¿…è¦é‡æ–°å®šä¹‰CRIï¼Œå¹¶ä¸”æä¾›ä¸€ç§æ’ä»¶æœºåˆ¶ï¼Œå…è®¸å®¹å™¨å¼•æ“ä»¥å¤–éƒ¨ç‹¬ç«‹è¿›ç¨‹çš„æ–¹å¼æ¥å…¥ã€‚æ‰€ä»¥ï¼ŒBrendan Burnsåœ¨<a href="http://hypercontainer.io" target="_blank" rel="external">Hyper</a>é›†æˆçš„æ—¶å€™å°±æä¾›äº†ä¸€ç§ä»¥å®¢æˆ·ç«¯/æœåŠ¡å™¨æ–¹å¼æ¥å…¥å¤–éƒ¨å®¹å™¨å¼•æ“çš„æ€è·¯ã€‚åœ¨å¤§é‡çš„ç¤¾åŒºè®¨è®ºåï¼ŒNode teamé‡æ–°æŠ½è±¡äº†å®¹å™¨å¼•æ“æ¥å£ï¼ˆä¹Ÿå°±æ˜¯CRIï¼‰ï¼Œå¹¶å†³å®šä»¥gRPCçš„æ–¹å¼æ¥å…¥å¤–éƒ¨å®¹å™¨å¼•æ“ã€‚</p>
<h2 id="CRIæ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#CRIæ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="CRIæ˜¯å¦‚ä½•å·¥ä½œçš„"></a>CRIæ˜¯å¦‚ä½•å·¥ä½œçš„</h2><p>CRIæ¯”Runtimeæ¥å£æä¾›äº†æ›´ç»†ç²’åº¦çš„æŠ½è±¡ï¼Œè§£è€¦äº†é•œåƒç®¡ç†å’Œå®¹å™¨ç®¡ç†ï¼Œå¹¶ä¸ºPodå’ŒContaineræä¾›äº†ç‹¬ç«‹çš„æ“ä½œæ¥å£ã€‚CRIä»¥gRPCçš„æ–¹å¼æ¥å…¥ï¼ŒKubeletæ˜¯gPRC APIçš„å®¢æˆ·ç«¯ï¼Œè€Œå®¹å™¨å¼•æ“åˆ™æ˜¯gRPC APIçš„æœåŠ¡ç«¯ã€‚gRPCå·²ç»è‡ªåŠ¨å®ç°äº†å®ƒä»¬ä¹‹é—´äº¤äº’çš„ç»†èŠ‚ï¼Œå®¹å™¨å¼•æ“åªéœ€è¦å®ç°æ¯ä¸ªå…·ä½“çš„APIã€‚</p>
<p>ä¸€ä¸ªå…¸å‹çš„å¯åŠ¨Podçš„æµç¨‹ä¸º</p>
<p><img src="/images/createpod.png" alt="createpod"></p>
<p>è€Œåœæ­¢Podçš„æµç¨‹ä¸º</p>
<p><img src="/images/killpod.png" alt="killpod"></p>
<h2 id="CRIå¸¦äº†ä»€ä¹ˆ"><a href="#CRIå¸¦äº†ä»€ä¹ˆ" class="headerlink" title="CRIå¸¦äº†ä»€ä¹ˆ"></a>CRIå¸¦äº†ä»€ä¹ˆ</h2><p>CRIè§£å†³äº†ä¸Šè¿°æåˆ°çš„Runtimeæ¥å£çš„é—®é¢˜ï¼Œä½¿å¾—æ–°çš„å®¹å™¨å¼•æ“å¯ä»¥æ›´æ–¹ä¾¿çš„é›†æˆåˆ°Kubernetesä¸­æ¥ï¼Œè¿™å¿…å°†ç»™Kubernetesç¤¾åŒºå¸¦æ¥æ–°ä¸€è½®çš„å˜é©ï¼Œå¹¶ä¿ƒè¿›Kubernetesèµ°å…¥æ›´å¤šçš„åº”ç”¨åœºæ™¯ä¸­ã€‚æ¯”å¦‚ï¼ŒRedhatå€ŸåŠ©OCIå®¹å™¨å¼•æ“runcæ‘†è„±å¯¹dockerä¾èµ–ï¼ŒHyperä»¥è™šæ‹ŸåŒ–çš„æ–¹å¼è§£å†³å¤šç§Ÿæˆ·åœºæ™¯ä¸‹çš„å®¹å™¨éš”ç¦»é—®é¢˜ï¼Œç”šè‡³Mirantisç›´æ¥ç”¨Kubernetesæ¥ç®¡ç†åŸç”Ÿçš„è™šæ‹Ÿæœºã€‚</p>
<p>CRIä¹Ÿè§£è€¦äº†å®¹å™¨å’Œé•œåƒçš„ç®¡ç†ï¼Œå¯ä»¥æ–¹ä¾¿çš„æ‰©å±•å…¶ä»–é•œåƒæ ¼å¼ï¼Œæ¯”å¦‚ACIç­‰ã€‚</p>
<p>CRIè¿˜åœ¨ç€åŠ›è§£å†³ä¸€äº›å¾ˆæœ‰æŒ‘æˆ˜çš„é—®é¢˜ï¼Œæ¯”å¦‚</p>
<ul>
<li>å®¹å™¨æ—¥å¿—çš„ç®¡ç†ï¼ŒåŒ…æ‹¬æ—¥å¿—æ ¼å¼åŒ–è§„èŒƒã€æ—¥å¿—æ–‡ä»¶rotateã€æ—¥å¿—æ–‡ä»¶ç£ç›˜IOæ§åˆ¶ä»¥åŠæ—¥å¿—çš„ç»Ÿä¸€æ”¶é›†å¤„ç†ç­‰ã€‚</li>
<li>è§£é™¤streaming APIï¼ˆexecã€attachã€logsç­‰ï¼‰å¯¹kubeletçš„ç½‘ç»œå‹åŠ›ã€‚å½“å‰æ‰€æœ‰çš„streaming APIéƒ½æ˜¯ä»<code>apiserver-&gt;kubelet-&gt;runtime</code>ï¼Œapiserveræ˜¯æ— çŠ¶æ€çš„ï¼Œå¯ä»¥æ°´å¹³æ‰©å±•ï¼Œä½†kubeletå’Œruntimeåˆ™æ˜¯æ¯å°æœºå™¨åªèƒ½æœ‰ä¸€ä¸ªï¼Œstreaming APIæœ‰å¯èƒ½ä¼šç»™ä»–ä»¬å¸¦æ¥å¤„ç†çš„ç“¶é¢ˆã€‚æ‰€ä»¥åœ¨CRIä¸­ï¼Œå°†ä¼šè€ƒè™‘ä½¿ç”¨ä¸€ä¸ªç‹¬ç«‹è¿›ç¨‹ï¼ˆéœ€è¦å¯¹apiserverå¼€æ”¾ç«¯å£ï¼‰æ¥å•ç‹¬å¤„ç†è¿™äº›è¯·æ±‚<code>apiserver-&gt;newStreamProcess</code>ï¼Œé‡Šæ”¾kubeletæ¥åšæ›´æ ¸å¿ƒçš„äº‹æƒ…ã€‚</li>
<li>æ›´çµæ´»çš„ç½‘ç»œé…ç½®ï¼Œå°†Podç½‘ç»œçš„é…ç½®å®Œå…¨äº¤ç»™å®¹å™¨å¼•æ“ï¼Œè€ŒKubernetesåªéœ€è¦æœ€ç»ˆçš„ç½‘ç»œçŠ¶æ€ã€‚</li>
</ul>
<h2 id="CRIçš„æœªæ¥"><a href="#CRIçš„æœªæ¥" class="headerlink" title="CRIçš„æœªæ¥"></a>CRIçš„æœªæ¥</h2><p>è™½ç„¶CRIè¿˜åœ¨æŒç»­å¼€å‘ä¸­ï¼ˆç›®å‰è¿˜æ²¡æœ‰ä»»ä½•releaseï¼‰ï¼Œä½†å·²ç»æœ‰å¾ˆå¤šå‚å•†å·²ç»å¼€å§‹äº†å¼•å…¥æ–°å®¹å™¨å¼•æ“çš„è¿›ç¨‹ï¼š</p>
<ul>
<li>Fraktiï¼šä¸ºè§£å†³å¤šç§Ÿæˆ·åœºæ™¯ä¸‹çš„å®¹å™¨éš”ç¦»é—®é¢˜ï¼ŒHyperä»¥è™šæ‹ŸåŒ–çš„æ–¹å¼è¿è¡Œå®¹å™¨ã€‚å…³äºfraktiçš„æ›´å¤šç»†èŠ‚è§<a href="https://github.com/kubernetes/fraktiã€‚" target="_blank" rel="external">https://github.com/kubernetes/fraktiã€‚</a></li>
<li>OCI-Oï¼šä¸ºè§£è€¦å¯¹dockerçš„ä¾èµ–ï¼ŒRedhatæä¾›å¯¹OCIå®¹å™¨å¼•æ“çš„æ”¯æŒï¼ˆç›®å‰ä¸»è¦æ˜¯runcï¼‰ã€‚å…³äºoci-oçš„æ›´å¤šç»†èŠ‚è§<a href="https://github.com/kubernetes-incubator/oci-oã€‚" target="_blank" rel="external">https://github.com/kubernetes-incubator/oci-oã€‚</a></li>
<li>Rktletï¼šä¸ºäº†åŠ é€Ÿrktå®¹å™¨å¼•æ“çš„å¼€å‘ç»´æŠ¤ï¼ŒCoreOSæè®®å°†rkté›†æˆçš„ä»£ç ç‹¬ç«‹å‡ºKubeletï¼ˆvendoråˆ°kubeletï¼ŒåŒé›†æˆåˆ°kubeletå†…éƒ¨ä¾¿äºå‘å¸ƒï¼‰ï¼Œå¹¶é‡æ„rktä»¥é€‚åº”CRIçš„å˜åŒ–ã€‚å…³äºrktletçš„æ›´å¤šç»†èŠ‚è§<a href="https://github.com/kubernetes-incubator/rktletã€‚" target="_blank" rel="external">https://github.com/kubernetes-incubator/rktletã€‚</a></li>
<li>Virtletï¼šä¸ºäº†æ”¯æŒåŸç”Ÿçš„è™šæ‹Ÿæœºç®¡ç†ï¼ŒMirantisæè®®ç›´æ¥ç”¨Kubernetesæ¥ç®¡ç†åŸç”Ÿçš„è™šæ‹Ÿæœºï¼ˆéœ€è¦å°†dockeré•œåƒæ›¿æ¢æˆqcow2é•œåƒï¼‰ã€‚å…³äºvirtletçš„æ›´å¤šç»†èŠ‚è§<a href="https://github.com/Mirantis/virtletã€‚" target="_blank" rel="external">https://github.com/Mirantis/virtletã€‚</a></li>
<li>å½“ç„¶ï¼Œdockerç›¸å…³çš„ä»£ç è¿˜ä¼šç»§ç»­ä¿ç•™åœ¨kubeletå†…éƒ¨ï¼Œåªä¸è¿‡è¦é‡æ„åˆ°CRIä¸Šé¢æ¥ã€‚</li>
</ul>
<p>CRIé¢„è®¡åœ¨Kubernetes v1.5å‘å¸ƒç¬¬ä¸€ä¸ªalphaç‰ˆã€‚å±Šæ—¶ï¼Œä¸Šé¢å„ä¸ªå®¹å™¨å¼•æ“çš„å®ç°ä¹Ÿå°†ä¼šå‘å¸ƒç¬¬ä¸€ä¸ªreleaseã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/qrcode.jpg"
               alt="Feisky" />
          <p class="site-author-name" itemprop="name">Feisky</p>
          <p class="site-description motion-element" itemprop="description">Notes about anything.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">93</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/feiskyer" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/feisky" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/371069890" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/feisky/" target="_blank" title="åšå®¢å›­">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  åšå®¢å›­
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Feisky</span>
</div>

<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = decodeURIComponent(data.url);
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


  


</body>
</html>
